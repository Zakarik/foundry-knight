<form class="mainFlex {{cssClass}}" autocomplete="off">

    {{#unless (isEmpty actor.evolutionsAchetables)}}
    <div class="evolutionsAchetables">
        {{#each actor.evolutionsAchetables as | key evolution|}}
            <button class="appliquer-evolution-armure" data-num="{{key.id}}">
                {{localize "KNIGHT.ITEMS.ARMURE.EVOLUTIONS.EvolutionDisponible"}} ({{key.value}}{{localize "KNIGHT.AUTRE.PointGloire-short"}}) - {{localize "KNIGHT.AUTRE.CliquezIci"}}
            </button>
        {{/each}}
    </div>
    {{/unless}}

    {{#unless (isEmpty actor.evolutionsCompanions)}}
    <div class="evolutionsAchetables">
        {{#each actor.evolutionsCompanions as | key evolution|}}
            <button class="appliquer-evolution-companions">
                {{localize "KNIGHT.ITEMS.ARMURE.EVOLUTIONS.EvolutionCompanionDisponible"}} ({{key.value}}{{localize "KNIGHT.AUTRE.PointGloire-short"}}) - {{localize "KNIGHT.AUTRE.CliquezIci"}}
            </button>
        {{/each}}
    </div>
    {{/unless}}

    {{!-- Sheet Header --}}
    <header class="sheet-header flexrow">
        <img class="profile-img" src="{{data.img}}" data-edit="img" title="{{data.name}}" />
        <div class="headerData">
            <div class="data">
                <h1 class="charname">
                    <input name="name" type="text" value="{{data.name}}" placeholder="{{localize "KNIGHT.Nom"}}" />
                </h1>

                <label>
                    <span>{{localize "KNIGHT.Surnom"}} : </span>
                    <input type="text" name="system.surnom" value="{{systemData.surnom}}" />
                </label>

                <label>
                    <span>{{localize "KNIGHT.Archetype"}} : </span>
                    <input type="text" name="system.archetype" value="{{systemData.archetype}}" />
                </label>

                <label>
                    <span>{{localize "KNIGHT.Age"}} : </span>
                    <input type="text" name="system.age" value="{{systemData.age}}" />
                </label>

                <label>
                    <span>{{localize "KNIGHT.Section"}} : </span>
                    <input type="text" name="system.section" value="{{systemData.section}}" />
                </label>

                <label>
                    <span>{{localize "KNIGHT.Blason"}} : </span>
                    <input type="text" name="system.blason" value="{{systemData.blason}}" />
                </label>

                <label>
                    <span>{{localize "KNIGHT.HautFait"}} : </span>
                    <input type="text" name="system.hautFait" value="{{systemData.hautFait}}" />
                </label>
            </div>

            <div class="buttonSelectArmure {{#unless systemData.jauges.sante}} centered {{/unless}}">
                {{#unless (ascension systemData.wear)}}
                    {{#unless actor.armureData._id}}
                    <button type="action" class="creerArmure unselected item-create" data-type="armure">{{localize "KNIGHT.ARMURE.CreerArmure"}}</button>
                    {{/unless}}

                    {{#if actor.armureData._id}}
                    <div class="blockArmure {{#if (armure systemData.wear)}} selected {{else}} unselected {{/if}} summary" data-item-id="{{actor.armureData._id}}">
                        <a class="item-edit" title="Edit Item"><i class="fas fa-edit"></i></a>
                        <button type="action" class="armure" data-type="armure">
                        {{systemData.equipements.armure.label}}
                        </button>
                        <a class="item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
                    </div>
                    {{/if}}
                {{/unless}}

                {{#if systemData.jauges.sante}}
                <button type="action" class="armure {{#if (guardian systemData.wear)}} selected {{else}} unselected {{/if}}" data-type="guardian">{{localize "KNIGHT.ARMURE.Guardian"}}</button>
                <button type="action" class="armure {{#if (civil systemData.wear)}} selected {{else}} unselected {{/if}}" data-type="tenueCivile">{{localize "KNIGHT.ARMURE.TenueCivile"}}</button>
                {{/if}}
            </div>
        </div>
    </header>

    {{!-- MENU LATERAL  --}}
    <section class="menu">
        <section class="mainBlock">
            <div class="styleCombat">
                <span class="label">{{localize "KNIGHT.COMBAT.STYLES.Label"}}</span>
                <span class="info {{#if systemData.combat.styleDeploy}} clicked {{/if}}">?</span>
                <span class="{{#if systemData.combat.styleDeploy}} showInfo {{else}} hideInfo {{/if}}">{{{systemData.combat.styleInfo}}}</span>
                <select name="system.combat.style">
                    {{#select systemData.combat.style}}
                    <option value="standard">{{localize "KNIGHT.COMBAT.STYLES.STANDARD.Label"}}</option>
                    <option value="acouvert">{{localize "KNIGHT.COMBAT.STYLES.ACOUVERT.Label"}}</option>
                    <option value="agressif">{{localize "KNIGHT.COMBAT.STYLES.AGRESSIF.Label"}}</option>
                    <option value="akimbo">{{localize "KNIGHT.COMBAT.STYLES.AKIMBO.Label"}}</option>
                    <option value="ambidextre">{{localize "KNIGHT.COMBAT.STYLES.AMBIDEXTRE.Label"}}</option>
                    <option value="defensif">{{localize "KNIGHT.COMBAT.STYLES.DEFENSIF.Label"}}</option>
                    <option value="pilonnage">{{localize "KNIGHT.COMBAT.STYLES.PILONNAGE.Label"}}</option>
                    <option value="precis">{{localize "KNIGHT.COMBAT.STYLES.PRECIS.Label"}}</option>
                    <option value="puissant">{{localize "KNIGHT.COMBAT.STYLES.PUISSANT.Label"}}</option>
                    <option value="suppression">{{localize "KNIGHT.COMBAT.STYLES.SUPPRESSION.Label"}}</option>
                    {{/select}}
                </select>
            </div>
        </section>

        <section class="mainBlock">
            {{#if systemData.jauges.sante}}
            <div class="sante">
                <div class="line">
                    <span class="option {{#unless systemData.sante.optionDeploy}}withBorder{{/unless}}"><img src="systems/knight/assets/icons/option.svg" class="option" data-option="sante"></span>
                    <span class="label {{#unless systemData.sante.optionDeploy}}withBorder{{/unless}}">{{localize "KNIGHT.LATERAL.Sante"}}</span>
                    <input class="{{#unless systemData.sante.optionDeploy}}withBorder{{/unless}}" type="number" name="system.sante.value" min="0" max="{{systemData.sante.max}}" value="{{systemData.sante.value}}" />
                    <span class="separation {{#unless systemData.sante.optionDeploy}}withBorder{{/unless}}">/</span>
                    <span class="score {{#unless systemData.sante.optionDeploy}}withBorder{{/unless}}" title="{{systemData.sante.base}} + {{systemData.sante.bonusValue}} - {{systemData.sante.malusValue}} = {{systemData.sante.max}}">{{systemData.sante.max}}</span>
                </div>
                <div class="subLine {{#if systemData.sante.optionDeploy}} optionShow {{else}} optionHide {{/if}}">
                    <span class="label">{{localize "KNIGHT.BONUS.Label"}}</span>
                    <input type="number" name="system.sante.bonus.user" data-type="sante" min="0" value="{{systemData.sante.bonus.user}}" />
                </div>
                <div class="subLine {{#if systemData.sante.optionDeploy}} optionShow {{else}} optionHide {{/if}}">
                    <span class="label withBorder">{{localize "KNIGHT.MALUS.Label"}}</span>
                    <input class="withBorder" type="number" name="system.sante.malus.user" data-type="sante" min="0" value="{{systemData.sante.malus.user}}" />
                </div>
            </div>
            {{/if}}

            {{#if systemData.jauges.egide}}
            <div class="egide">
                <div class="line">
                    <span class="option"><img src="systems/knight/assets/icons/option.svg" class="option" data-option="egide"></span>
                    <span class="label" title="{{localize "KNIGHT.LATERAL.ChampDeForce"}}">{{localize "KNIGHT.LATERAL.Egide"}}</span>
                    <span class="score" title="{{systemData.egide.base}} + {{systemData.egide.bonusValue}} - {{systemData.egide.malusValue}} = {{systemData.egide.value}}">{{systemData.egide.value}}</span>
                </div>
                <div class="subLine {{#if systemData.egide.optionDeploy}} optionShow {{else}} optionHide {{/if}}">
                    <span class="label">{{localize "KNIGHT.AUTRE.Base"}}</span>
                    <input type="number" name="system.egide.base" data-type="egide"  min="0"
                    value="{{systemData.egide.base}}" />
                </div>
                <div class="subLine {{#if systemData.egide.optionDeploy}} optionShow {{else}} optionHide {{/if}}">
                    <span class="label">{{localize "KNIGHT.BONUS.Label"}}</span>
                    <input type="number" name="system.egide.bonus.user" data-type="egide"  min="0"
                    value="{{systemData.egide.bonus.user}}" />
                </div>
                <div class="subLine {{#if systemData.egide.optionDeploy}} optionShow {{else}} optionHide {{/if}}">
                    <span class="label">{{localize "KNIGHT.MALUS.Label"}}</span>
                    <input type="number" name="system.egide.malus.user" data-type="egide"  min="0"
                    value="{{systemData.egide.malus.user}}" />
                </div>
                <button type="action" class="jetEgide" data-value="{{systemData.egide.value}}D6">{{localize "KNIGHT.JETS.JetEgide"}}</button>
            </div>
            {{/if}}

            {{#if systemData.jauges.espoir}}
            <div class="espoir">
                <div class="line">
                    <span class="option"><img src="systems/knight/assets/icons/option.svg" class="option" data-option="espoir"></span>
                    <span class="label">{{localize "KNIGHT.LATERAL.Espoir"}}</span>
                    <input type="number" name="system.espoir.value" min="0" max="{{systemData.espoir.max}}" value="{{systemData.espoir.value}}" />
                    <span class="separation">/</span>
                    <span class="score" title="50 + {{systemData.espoir.bonusValue}} - {{systemData.espoir.malusValue}} = {{systemData.espoir.value}}">{{systemData.espoir.max}}</span>
                </div>
                <div class="subLine {{#if systemData.espoir.optionDeploy}} optionShow {{else}} optionHide {{/if}}">
                    <span class="label">{{localize "KNIGHT.BONUS.Label"}}</span>
                    <input type="number" name="system.espoir.bonus.user" min="0" value="{{systemData.espoir.bonus.user}}" />
                </div>
                <div class="subLine {{#if systemData.espoir.optionDeploy}} optionShow {{else}} optionHide {{/if}}">
                    <span class="label">{{localize "KNIGHT.MALUS.Label"}}</span>
                    <input type="number" name="system.espoir.malus.user" min="0" value="{{systemData.espoir.malus.user}}" />
                </div>
                <button type="action" class="jetEspoir">{{localize "KNIGHT.JETS.JetEspoir"}}</button>
            </div>
            {{/if}}

            {{#if systemData.jauges.heroisme}}
            <div class="heroisme">
                <div class="line">
                    <span class="label">{{localize "KNIGHT.LATERAL.Heroisme"}}</span>
                    <input type="number" name="system.heroisme.value" min="0" max="{{systemData.heroisme.max}}" value="{{systemData.heroisme.value}}" />
                    <span class="separation">/</span>
                    <span class="score">{{systemData.heroisme.max}}</span>
                </div>
            </div>
            {{/if}}
        </section>

        <section class="mainBlock {{#unless systemData.jauges.armure}}hidden{{/unless}}">
            {{#if systemData.jauges.armure}}
            <div class="armure">
                <div class="line">
                    <span class="option {{#unless systemData.armure.optionDeploy}}withBorder{{/unless}}"><img src="systems/knight/assets/icons/option.svg" class="option" data-option="armure"></span>
                    <span class="label {{#unless systemData.armure.optionDeploy}}withBorder{{/unless}}">{{localize "KNIGHT.LATERAL.Armure"}}</span>
                    <input class="value {{#unless systemData.armure.optionDeploy}}withBorder{{/unless}}" type="number" name="system.armure.value" min="0" max="{{systemData.armure.max}}" value="{{systemData.armure.value}}" />
                    <span class="separation {{#unless systemData.armure.optionDeploy}}withBorder{{/unless}}">/</span>
                    <span class="score {{#unless systemData.armure.optionDeploy}}withBorder{{/unless}}" title="{{systemData.armure.base}} + {{systemData.armure.bonus}} - {{systemData.armure.malus}} = {{systemData.armure.max}}">{{systemData.armure.max}}</span>
                </div>
                <div class="subLine {{#if systemData.armure.optionDeploy}} optionShow {{else}} optionHide {{/if}}">
                    <span class="label">{{localize "KNIGHT.BONUS.Label"}}</span>
                    <input type="number" name="system.equipements.{{systemData.wear}}.armure.bonus.user" data-type="armure"  min="0" value="{{#if (guardian systemData.wear)}}{{systemData.equipements.guardian.armure.bonus.user}}{{/if}}{{#if (armure systemData.wear)}}{{systemData.equipements.armure.armure.bonus.user}}{{/if}}{{#if (ascension systemData.wear)}}{{systemData.equipements.ascension.armure.bonus.user}}{{/if}}" />
                </div>
                <div class="subLine {{#if systemData.armure.optionDeploy}} optionShow {{else}} optionHide {{/if}}">
                    <span class="label withBorder">{{localize "KNIGHT.MALUS.Label"}}</span>
                    <input class="withBorder" type="number" name="system.equipements.{{systemData.wear}}.armure.malus.user" data-type="armure"  min="0" value="{{#if (guardian systemData.wear)}}{{systemData.equipements.guardian.armure.malus.user}}{{/if}}{{#if (armure systemData.wear)}}{{systemData.equipements.armure.armure.malus.user}}{{/if}}{{#if (ascension systemData.wear)}}{{systemData.equipements.ascension.armure.malus.user}}{{/if}}" />
                </div>
            </div>
            {{/if}}

            {{#if systemData.jauges.energie}}
            <div class="energie">
                <div class="line">
                    <span class="option {{#unless systemData.energie.optionDeploy}}withBorder{{/unless}}"><img src="systems/knight/assets/icons/option.svg" class="option" data-option="energie"></span>
                    <span class="label {{#unless systemData.energie.optionDeploy}}withBorder{{/unless}}">{{localize "KNIGHT.LATERAL.Energie"}}</span>
                    <input class="{{#unless systemData.energie.optionDeploy}}withBorder{{/unless}}" type="number" name="system.energie.value" min="0" max="{{systemData.energie.max}}" value="{{systemData.energie.value}}" />
                    <span class="separation {{#unless systemData.energie.optionDeploy}}withBorder{{/unless}}">/</span>
                    <span class="score {{#unless systemData.energie.optionDeploy}}withBorder{{/unless}}" title="{{systemData.energie.base}} + {{systemData.energie.bonus}} - {{systemData.energie.malus}} = {{systemData.energie.max}}">{{systemData.energie.max}}</span>
                </div>
                <div class="subLine {{#if systemData.energie.optionDeploy}} optionShow {{else}} optionHide {{/if}}">
                    <span class="label">{{localize "KNIGHT.BONUS.Label"}}</span>
                    <input type="number" name="system.equipements.{{systemData.wear}}.energie.bonus.user" data-type="energie"  min="0" value="{{#if (guardian systemData.wear)}}{{systemData.equipements.guardian.energie.bonus.user}}{{/if}}{{#if (armure systemData.wear)}}{{systemData.equipements.armure.energie.bonus.user}}{{/if}}{{#if (ascension systemData.wear)}}{{systemData.equipements.ascension.energie.bonus.user}}{{/if}}" />
                </div>
                <div class="subLine {{#if systemData.energie.optionDeploy}} optionShow {{else}} optionHide {{/if}}">
                    <span class="label withBorder">{{localize "KNIGHT.MALUS.Label"}}</span>
                    <input class="withBorder" type="number" name="system.equipements.{{systemData.wear}}.energie.malus.user" data-type="energie"  min="0" value="{{#if (guardian systemData.wear)}}{{systemData.equipements.guardian.energie.malus.user}}{{/if}}{{#if (armure systemData.wear)}}{{systemData.equipements.armure.energie.malus.user}}{{/if}}{{#if (ascension systemData.wear)}}{{systemData.equipements.ascension.energie.malus.user}}{{/if}}" />
                </div>
            </div>
            {{/if}}

            {{#if systemData.jauges.champDeForce}}
            <div class="champDeForce">
                <div class="line">
                    <span class="option {{#unless systemData.champDeForce.optionDeploy}} withBorder {{else}} withoutBorder {{/unless}}"><img src="systems/knight/assets/icons/option.svg" class="option" data-option="champDeForce"></span>
                    <span class="label {{#unless systemData.champDeForce.optionDeploy}} withBorder {{/unless}}" title="{{localize "KNIGHT.LATERAL.ChampDeForce"}}">{{localize "KNIGHT.LATERAL.ChampDeForce-short"}}</span>
                    <span class="score {{#unless systemData.champDeForce.optionDeploy}} withBorder {{/unless}}" title="{{systemData.champDeForce.base}} + {{systemData.champDeForce.bonus}} - {{systemData.champDeForce.malus}} = {{systemData.champDeForce.value}}">{{systemData.champDeForce.value}}</span>
                </div>
                <div class="subLine {{#if systemData.champDeForce.optionDeploy}} optionShow {{else}} optionHide {{/if}}">
                    <span class="label">{{localize "KNIGHT.BONUS.Label"}}</span>
                    <input type="number" name="system.equipements.{{this.systemData.wear}}.champDeForce.bonus.user" data-type="champDeForce"  min="0"
                    value="{{#if (guardian systemData.wear)}}{{systemData.equipements.guardian.champDeForce.bonus.user}}{{/if}}{{#if (armure systemData.wear)}}{{systemData.equipements.armure.champDeForce.bonus.user}}{{/if}}{{#if (ascension systemData.wear)}}{{systemData.equipements.ascension.champDeForce.bonus.user}}{{/if}}" />
                </div>
                <div class="subLine {{#if systemData.champDeForce.optionDeploy}} optionShow {{else}} optionHide {{/if}}">
                    <span class="label withBorder">{{localize "KNIGHT.MALUS.Label"}}</span>
                    <input class="withBorder" type="number" name="system.equipements.{{this.systemData.wear}}.champDeForce.malus.user" data-type="champDeForce"  min="0" value="{{#if (guardian systemData.wear)}}{{systemData.equipements.guardian.champDeForce.malus.user}}{{/if}}{{#if (armure systemData.wear)}}{{systemData.equipements.armure.champDeForce.malus.user}}{{/if}}{{#if (ascension systemData.wear)}}{{systemData.equipements.ascension.champDeForce.malus.user}}{{/if}}" />
                </div>
            </div>
            {{/if}}

            {{#if systemData.jauges.flux}}
            <div class="flux">
                <div class="line">
                    <span class="label withBorder" title="{{localize "KNIGHT.LATERAL.Flux"}}">{{localize "KNIGHT.LATERAL.Flux"}}</span>
                    <input class="withBorder" type="number" name="system.flux.value" min="0" value="{{systemData.flux.value}}" />
                </div>
            </div>
            {{/if}}

            {{#if (hasSpecial 'contrecoups' actor.armureData.system.special.selected)}}
                {{#unless actor.armureData.system.special.selected.contrecoups.unactif}}
                <div class="contrecoups">
                    <div class="line">
                        <span class="label withBorder" title="{{localize "KNIGHT.ITEMS.ARMURE.SPECIAL.CONTRECOUPS.Label"}}">{{localize "KNIGHT.ITEMS.ARMURE.SPECIAL.CONTRECOUPS.Label"}}</span>
                        <input class="withBorder" type="number" name="system.equipements.armure.special.contrecoups" min="0" value="{{systemData.equipements.armure.special.contrecoups}}" />
                    </div>
                </div>
                {{/unless}}
            {{/if}}

            {{#if (hasSpecial 'impregnation' actor.armureData.system.special.selected)}}
            <div class="impregnation">
                <div class="line">
                    <span class="label withBorder" title="{{localize "KNIGHT.ITEMS.ARMURE.SPECIAL.IMPREGNATION.Label"}}">{{localize "KNIGHT.ITEMS.ARMURE.SPECIAL.IMPREGNATION.Label"}}</span>
                    <input class="withBorder" type="number" name="system.equipements.armure.special.impregnation" min="0" value="{{systemData.equipements.armure.special.impregnation}}" />
                </div>
            </div>
            {{/if}}
        </section>

        <section class="mainBlock">
            <div class="reaction">
                <div class="line">
                    <span class="option {{#unless systemData.reaction.optionDeploy}} withBorder {{else}} withoutBorder  {{/unless}}"><img src="systems/knight/assets/icons/option.svg" class="option" data-option="reaction"></span>
                    <span class="label {{#unless systemData.reaction.optionDeploy}} withBorder {{/unless}}">{{localize "KNIGHT.LATERAL.Reaction"}}</span>
                    <span class="score {{#unless systemData.reaction.optionDeploy}} withBorder {{/unless}}" title="{{systemData.reaction.base}} + {{systemData.reaction.bonusValue}} - {{systemData.reaction.malusValue}} = {{systemData.reaction.value}}">{{systemData.reaction.value}}</span>
                </div>
                <div class="subLine {{#if systemData.reaction.optionDeploy}} optionShow {{else}} optionHide {{/if}}">
                    <span class="label">{{localize "KNIGHT.BONUS.Label"}}</span>
                    <input type="number" name="system.reaction.bonus.user" min="0" value="{{systemData.reaction.bonus.user}}" />
                </div>
                <div class="subLine {{#if systemData.reaction.optionDeploy}} optionShow {{else}} optionHide {{/if}}">
                    <span class="label withBorder">{{localize "KNIGHT.MALUS.Label"}}</span>
                    <input class="withBorder" type="number" name="system.reaction.malus.user" min="0" value="{{systemData.reaction.malus.user}}" />
                </div>
            </div>

            <div class="defense">
                <div class="line">
                    <span class="option {{#unless systemData.defense.optionDeploy}} withBorder {{else}} withoutBorder  {{/unless}}"><img src="systems/knight/assets/icons/option.svg" class="option" data-option="defense"></span>
                    <span class="label {{#unless systemData.defense.optionDeploy}} withBorder {{/unless}}">{{localize "KNIGHT.LATERAL.Defense"}}</span>
                    <span class="score {{#unless systemData.defense.optionDeploy}} withBorder {{/unless}}" title="{{systemData.defense.base}} + {{systemData.defense.bonusValue}} - {{systemData.defense.malusValue}} = {{systemData.defense.value}}">{{systemData.defense.value}}</span>
                </div>
                <div class="subLine {{#if systemData.defense.optionDeploy}} optionShow {{else}} optionHide {{/if}}">
                    <span class="label">{{localize "KNIGHT.BONUS.Label"}}</span>
                    <input type="number" name="system.defense.bonus.user" min="0" value="{{systemData.defense.bonus.user}}" />
                </div>
                <div class="subLine {{#if systemData.defense.optionDeploy}} optionShow {{else}} optionHide {{/if}}">
                    <span class="label withBorder">{{localize "KNIGHT.MALUS.Label"}}</span>
                    <input class="withBorder" type="number" name="system.defense.malus.user" min="0" value="{{systemData.defense.malus.user}}" />
                </div>
            </div>

            <div class="initiative">
                <div class="line">
                    <span class="option {{#if systemData.initiative.optionDeploy}} withoutBorder  {{/if}}"><img src="systems/knight/assets/icons/option.svg" class="option" data-option="initiative"></span>
                    <span class="label">{{localize "KNIGHT.LATERAL.Initiative"}}</span>
                    <span class="score">
                        {{systemData.initiative.dice}}{{localize "KNIGHT.JETS.Des-short"}}6+{{systemData.initiative.value}}
                    </span>
                </div>
                <div class="subLine {{#if systemData.initiative.optionDeploy}} optionShow {{else}} optionHide {{/if}}">
                    <span class="label">{{localize "KNIGHT.JETS.Des"}}</span>
                    <input type="number" name="system.initiative.diceBase" min="0" value="{{systemData.initiative.diceBase}}" />
                </div>
                <div class="subLine {{#if systemData.initiative.optionDeploy}} optionShow {{else}} optionHide {{/if}}">
                    <span class="label">{{localize "KNIGHT.BONUS.Label"}}</span>
                    <input type="number" name="system.initiative.bonus.user" min="0" value="{{systemData.initiative.bonus.user}}" />
                </div>
                <div class="subLine {{#if systemData.initiative.optionDeploy}} optionShow {{else}} optionHide {{/if}}">
                    <span class="label">{{localize "KNIGHT.MALUS.Label"}}</span>
                    <input type="number" name="system.initiative.malus.user" min="0" value="{{systemData.initiative.malus.user}}" />
                </div>
            </div>
        </section>
    </section>

    {{!-- Sheet Body --}}
    <section class="body">
        {{!-- Sheet Tab Navigation --}}
        <nav class="sheet-tabs tabs" data-group="primary">
            <a class="item" data-tab="personnage">{{localize "KNIGHT.PERSONNAGE.Label"}}</a>
            <a class="item" data-tab="aspectsCaracteristiques">{{localize "KNIGHT.ASPECTS.Label"}}</a>
            {{#if systemData.options.art}}
            <a class="item" data-tab="art">{{localize "KNIGHT.ART.Label"}}</a>
            {{/if}}
            {{#if actor.armureData._id}}
                <a class="item" data-tab="armure">{{systemData.equipements.armure.label}}</a>
            {{/if}}
            <a class="item" data-tab="combat">{{localize "KNIGHT.COMBAT.Label"}}</a>
            <a class="item" data-tab="historique">{{localize "KNIGHT.HISTORIQUE.Label"}}</a>
            <a class="item" data-tab="progression">{{localize "KNIGHT.PROGRESSION.Label"}}</a>
            <a class="item" data-tab="options">{{localize "KNIGHT.OPTIONS.Label"}}</a>
        </nav>

        {{!-- Personnage Tab --}}
        <div class="tab personnage" data-group="primary" data-tab="personnage">
            <div class="motivations">
                <div class="majeure">
                    <h2 class="header">{{localize "KNIGHT.PERSONNAGE.MotivationMajeure"}}</h2>

                    <textarea name="system.motivations.majeure">{{systemData.motivations.majeure}}</textarea>
                </div>

                <div class="mineure item-list">
                    <h2 class="header">
                        {{localize "KNIGHT.PERSONNAGE.MotivationMineures"}}
                        {{#unless systemData.espoir.recuperation.aucun}}
                        <button type="action" class="motivationAccomplie">{{localize "KNIGHT.PERSONNAGE.MotivationAccomplie"}}</button>
                        {{/unless}}
                        <a class="item-control item-create" title="Create Item" data-type="motivationMineure"><i class="fas fa-plus"></i></a>
                    </h2>
                    {{#each actor.motivationMineure as | key motivation|}}
                    <div class="block summary item" data-item-id="{{key._id}}">
                        <div class="gestionButton">
                            <a class="item-control item-edit" title="Edit Item"><i class="fas fa-edit"></i></a>
                            <a class="item-control item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
                        </div>
                        <span class="description">
                            {{{key.system.description}}}
                        </span>
                    </div>
                    {{/each}}
                </div>
            </div>

            <div class="avDv">
                <div class="av item-list">
                    <h2 class="header">
                        {{localize "KNIGHT.PERSONNAGE.Avantages"}}
                        <a class="item-control item-create" title="Create Item" data-type="avantage"><i class="fas fa-plus"></i></a>
                    </h2>
                    {{#each actor.avantages as | key avantages|}}
                    <div class="block item" data-item-id="{{key._id}}">
                        <header class="summary header js-toggler" data-item-id="{{key._id}}">
                            <i class="far fa-plus-square extendButton"></i>
                            <div class="gestionButton">
                                <a class="item-control item-edit" title="Edit Item"><i class="fas fa-edit"></i></a>
                                <a class="item-control item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
                            </div>
                            <span>{{key.name}}</span>
                        </header>
                        <span class="description">
                            {{{key.system.description}}}
                        </span>
                    </div>
                    {{/each}}
                </div>

                <div class="dv item-list">
                    <h2 class="header">
                        {{localize "KNIGHT.PERSONNAGE.Inconvenient"}}
                        <a class="item-control item-create" title="Create Item" data-type="inconvenient"><i class="fas fa-plus"></i></a>
                    </h2>
                    {{#each actor.inconvenient as | key inconvenient|}}
                    <div class="block item" data-item-id="{{key._id}}">
                        <header class="summary header js-toggler" data-item-id="{{key._id}}">
                            <i class="far fa-plus-square extendButton"></i>
                            <div class="gestionButton">
                                <a class="item-control item-edit" title="Edit Item"><i class="fas fa-edit"></i></a>
                                <a class="item-control item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
                            </div>
                            <span>{{key.name}}</span>
                        </header>
                        <span class="description">
                            {{{key.system.description}}}
                        </span>
                    </div>
                    {{/each}}
                </div>
            </div>

            {{#if actor.distinctions}}
            <div class="distinction item-list">
                <h2 class="header">
                    {{localize "KNIGHT.PERSONNAGE.Distinctions"}}
                </h2>
                {{#each actor.distinctions as | key distinctions|}}
                <div class="block item" data-item-id="{{key._id}}">
                    <header class="summary header js-toggler" data-item-id="{{key._id}}">
                        <i class="far fa-plus-square extendButton"></i>
                        <div class="gestionButton">
                            <a class="item-control item-edit" title="Edit Item"><i class="fas fa-edit"></i></a>
                            <a class="item-control item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
                        </div>
                        <span>{{key.name}}</span>
                    </header>
                    <span class="description">
                        {{{key.system.description}}}
                    </span>
                </div>
                {{/each}}
            </div>
            {{/if}}

            <div class="heroisme">
                <div class="liste item-list">
                    <h2 class="header">
                        {{localize "KNIGHT.HEROISME.CARTE.Label"}}
                        <a class="item-control item-create" title="Create Item" data-type="carteheroique"><i class="fas fa-plus"></i></a>
                    </h2>
                    {{#each actor.carteHeroique as | key heroisme|}}
                    <div class="block item" data-item-id="{{key._id}}">
                        <header class="summary header js-toggler" data-item-id="{{key._id}}">
                            <i class="far fa-plus-square extendButton"></i>
                            <div class="gestionButton">
                                <a class="item-control item-edit" title="Edit Item"><i class="fas fa-edit"></i></a>
                                <a class="item-control item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
                            </div>
                            <span>{{key.name}}</span>
                        </header>
                        <span class="description">
                            {{{key.system.description}}}
                        </span>
                    </div>
                    {{/each}}
                </div>

                <div class="liste item-list">
                    <h2 class="header">
                        {{localize "KNIGHT.HEROISME.CAPACITE.Label"}}
                        <a class="item-control item-create" title="Create Item" data-type="capaciteheroique"><i class="fas fa-plus"></i></a>
                    </h2>
                    {{#each actor.capaciteHeroique as | key heroisme|}}
                    <div class="block item" data-item-id="{{key._id}}">
                        <header class="summary header js-toggler" data-item-id="{{key._id}}">
                            <i class="far fa-plus-square extendButton"></i>
                            <div class="gestionButton">
                                <a class="item-control item-edit" title="Edit Item"><i class="fas fa-edit"></i></a>
                                <a class="item-control item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
                            </div>
                            <span>{{key.name}}</span>
                        </header>
                        <span class="description">
                            {{{key.system.description}}}
                        </span>
                    </div>
                    {{/each}}
                </div>
            </div>

            <div class="description">
                <h2 class="header">{{localize "KNIGHT.Description"}}</h2>

                {{editor systemData.description target="system.description" button=true owner=owner editable=editable}}
            </div>
        </div>

        <div class="tab aspectsCaracteristiques" data-group="primary" data-tab="aspectsCaracteristiques">
            <div class="listeAspects">
                {{#each systemData.aspects as | key aspect|}}
                <div class="aspect">
                    <h2 class="header">
                        {{getAspect aspect}}
                        <img src="systems/knight/assets/icons/optionWhite.svg" class="edit" title="{{localize "KNIGHT.AUTRE.Editer"}}" data-aspect="{{aspect}}" />
                    </h2>
                    <span class="aspectLabel">{{key.value}}</span>
                    <div class="caracteristiques">
                        {{#each key.caracteristiques as | keyCar caracteristique|}}
                            <div class="line roll" title="{{localize "KNIGHT.JETS.Label"}}" data-caracteristique="{{caracteristique}}">
                                <img src="systems/knight/assets/icons/D6Black.svg" />
                                <label class="carac">
                                    <span class="label">{{getCarac caracteristique}}</span>
                                    <span class="score">{{keyCar.value}}</span>
                                </label>
                                <label class="overdrive">
                                    <span class="label">{{localize "KNIGHT.ASPECTS.OD"}}</span>
                                    <span class="score">{{keyCar.overdrive.value}}</span>
                                </label>
                            </div>
                        {{/each}}
                    </div>
                    <textarea name="system.aspects.{{aspect}}.description">{{key.description}}</textarea>
                </div>
                {{/each}}
            </div>
        </div>

        <div class="tab art" data-group="primary" data-tab="art">
            <div class="artFull">
                <h2 class="header summary" data-item-id="{{actor.art._id}}">
                    {{#if actor.art._id}}

                    {{actor.art.name}}
                    <div class="multiButton">
                        {{#if (canRoll 'pj' actor.art.system.jet.c1)}}
                        <button type="action" class="roll" data-caracteristique="{{actor.art.system.jet.c1}}" data-caraclock="{{actor.art.system.jet.c1}}" data-label="{{actor.art.name}}" data-nood="true">
                            {{localize "KNIGHT.JETS.Label"}} : {{getCarac actor.art.system.jet.c1}}
                        </button>
                        {{/if}}
                        {{#if (canRoll 'pj' actor.art.system.jet.c2)}}
                        <button type="action" class="roll" data-caracteristique="{{actor.art.system.jet.c2}}" data-caraclock="{{actor.art.system.jet.c2}}" data-label="{{actor.art.name}}" data-nood="true">
                            {{localize "KNIGHT.JETS.Label"}} : {{getCarac actor.art.system.jet.c2}}
                        </button>
                        {{/if}}
                    </div>
                    <div class="gestionButton">
                        <a class="item-edit" title="Edit Item"><i class="fas fa-edit"></i></a>
                        <a class="item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
                    </div>

                    {{else}}
                    {{localize "KNIGHT.ART.Label"}}
                    <a class="item-control item-create" title="Create Item" data-type="art"><i class="fas fa-plus"></i></a>
                    {{/if}}
                </h2>
                <span class="description">
                    {{{actor.art.system.description}}}
                </span>
                {{#if actor.art.system.pratique.has}}
                    <div class="col">
                        <div class="pratique">
                            <h2 class="header js-toggler">
                                <i class="far fa-minus-square"></i>
                                {{localize "KNIGHT.ART.PRATIQUE.Label"}}
                            </h2>
                            <h3>{{localize "KNIGHT.ART.PRATIQUE.Base"}}
                                <a class="art-say" data-type="base"><i class="fa-solid fa-comment-dots"></i></a>
                            </h3>
                            <span>{{{capaciteDescription actor.art.system.pratique.base}}}</span>
                            <h3>{{localize "KNIGHT.ART.PRATIQUE.Apprenti"}}
                                <a class="art-say" data-type="apprenti"><i class="fa-solid fa-comment-dots"></i></a>
                            </h3>
                            <span>{{{capaciteDescription actor.art.system.pratique.apprenti}}}</span>
                            <h3>{{localize "KNIGHT.ART.PRATIQUE.Initie"}}
                                <a class="art-say" data-type="initie"><i class="fa-solid fa-comment-dots"></i></a>
                            </h3>
                            <span>{{{capaciteDescription actor.art.system.pratique.initie}}}</span>
                            <h3>
                                {{localize "KNIGHT.ART.PRATIQUE.Maitre"}}
                                <a class="art-say" data-type="maitre"><i class="fa-solid fa-comment-dots"></i></a>
                            </h3>
                            <span>{{{capaciteDescription actor.art.system.pratique.maitre}}}</span>
                        </div>

                        <div class="recuperation">
                            <h2 class="header js-toggler">
                                <i class="far fa-minus-square"></i>
                                {{localize "KNIGHT.ART.RecuperationEspoir"}}
                            </h2>
                            <button type="action" class="rollRecuperationArt" data-value="1D6">1{{localize "KNIGHT.JETS.Des-short"}}6</button>
                            <button type="action" class="rollRecuperationArt" data-value="2D6">2{{localize "KNIGHT.JETS.Des-short"}}6</button>
                            <button type="action" class="rollRecuperationArt" data-value="3D6">3{{localize "KNIGHT.JETS.Des-short"}}6</button>
                            <button type="action" class="rollRecuperationArt" data-value="4D6">4{{localize "KNIGHT.JETS.Des-short"}}6</button>
                        </div>
                    </div>
                {{/if}}

                {{#if actor.art.system.oeuvre.has}}
                    <div class="col">
                        <div class="oeuvre">
                            <h2 class="header js-toggler">
                                <i class="far fa-minus-square"></i>
                                {{localize "KNIGHT.ART.OEUVRE.Label"}}
                            </h2>
                            <div class="shortspan">
                                <span class="label">{{localize "KNIGHT.ART.OEUVRE.Court"}}</span>
                                <span class="score">{{actor.art.system.oeuvre.temps.court}}</span>
                            </div>
                            <div class="shortspan">
                                <span class="label">{{localize "KNIGHT.ART.OEUVRE.Moyen"}}</span>
                                <span class="score">{{actor.art.system.oeuvre.temps.moyen}}</span>
                            </div>
                            <div class="shortspan">
                                <span class="label">{{localize "KNIGHT.ART.OEUVRE.Long"}}</span>
                                <span class="score">{{actor.art.system.oeuvre.temps.long}}</span>
                            </div>
                            <span class="description">{{{capaciteDescription actor.art.system.oeuvre.base}}}</span>
                        </div>

                        <div class="listeoeuvre">
                            <h2 class="header js-toggler">
                                <i class="far fa-minus-square"></i>
                                {{localize "KNIGHT.ART.OEUVRE.Liste"}}
                            </h2>
                            {{#each actor.art.system.oeuvre.liste  as | key oeuvre|}}
                            <div>
                                <span class="label">{{key.name}}</span>
                                <span class="description">{{{capaciteDescription key.description}}}</span>
                            </div>
                            {{/each}}
                        </div>
                    </div>
                {{/if}}
            </div>
        </div>

        <div class="tab armure" data-group="primary" data-tab="armure">
            <section class="buttonTabs">
                <a {{#if systemData.MATabs.MAarmure}}style="background:RGB(076 074 090)"{{/if}} data-tab="MAarmure">{{localize "KNIGHT.ARMURE.Label"}}</a>
                <a {{#if systemData.MATabs.MAmodule}}style="background:RGB(076 074 090)"{{/if}} data-tab="MAmodule">{{localize "KNIGHT.ITEMS.MODULE.Label"}}</a>
                <a {{#if systemData.MATabs.MAia}}style="background:RGB(076 074 090)"{{/if}} data-tab="MAia">{{localize "KNIGHT.IA.Label"}}</a>
            </section>

            <section class="tabArmure">
                <div class="tab-armure MAarmure {{#if systemData.MATabs.MAarmure}}active{{/if}}">
                    <div class="capacites">
                        <h2 class="header js-toggler">
                            <i class="far fa-minus-square"></i>
                            {{localize "KNIGHT.CAPACITES.Label"}}
                        </h2>
                        {{#each actor.armureData.system.capacites.selected as | key selected|}}
                            {{#if (capaciteIsValid . key)}} {{~> (affichageCapacite . key) data=@root/systemData/equipements/armure/capacites}} {{else}} {{log "ERREUR ! " @root/data level="error"}} {{/if}}
                        {{/each}}
                    </div>

                    <div class="special">
                        <h2 class="header js-toggler">
                            <i class="far fa-minus-square"></i>
                            {{localize "KNIGHT.ITEMS.ARMURE.Special"}}
                        </h2>
                        {{#each actor.armureData.system.special.selected as | key selected|}}
                            {{#if (capaciteIsValid . key)}} {{~> (affichageSpecial . key)}} {{else}} {{log "ERREUR ! " @root/data level="error"}}{{/if}}
                        {{/each}}
                    </div>

                    {{#unless (isEmpty actor.armureLegendeData)}}
                    <div class="capacites capacitesLegende">
                        <h2 class="header js-toggler summary" data-item-id="{{actor.armureLegendeData._id}}">
                            <i class="far fa-minus-square"></i>
                            {{localize "ITEM.TypeArmurelegende"}} : {{localize "KNIGHT.CAPACITES.Label"}}

                            <a class="item-edit" title="Edit Item"><i class="fas fa-edit"></i></a>
                            <a class="item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
                        </h2>
                        {{#each actor.armureLegendeData.system.capacites.selected as | key selected|}}
                            {{#if (capaciteIsValid . key)}} {{~> (affichageCapaciteLegende . key) data=@root/systemData/equipements/armure/capacites}} {{else}} {{log "ERREUR ! " @root/data level="error"}} {{/if}}
                        {{/each}}
                    </div>
                    {{/unless}}

                    {{#unless (isEmpty actor.armureLegendeData)}}
                    <div class="capacites specialLegende">
                        <h2 class="header js-toggler">
                            <i class="far fa-minus-square"></i>
                            {{localize "ITEM.TypeArmurelegende"}} : {{localize "KNIGHT.ITEMS.ARMURE.Special"}}
                        </h2>
                        {{#each actor.armureLegendeData.system.special.selected as | key selected|}}
                            {{#if (capaciteIsValid . key)}} {{~> (affichageSpecialLegende . key)}} {{else}} {{log "ERREUR ! " @root/data level="error"}}{{/if}}
                        {{/each}}
                    </div>
                    {{/unless}}

                    {{#if actor.capaciteultime}}
                    <div class="capacites capacitesultime">
                        <h2 class="header js-toggler summary" data-item-id="{{actor.capaciteultime._id}}">
                            <i class="far fa-minus-square"></i>
                            {{actor.capaciteultime.name}}

                            {{#if ("armure" actor.system.wear)}}
                                {{#with actor.capaciteultime}}
                                    {{#if (isValue this.system.type 'passive')}}
                                        {{#if this.system.passives.capacites.actif}}
                                            {{#if this.system.passives.capacites.ascension.actif}}
                                                {{#if this.system.passives.capacites.ascension.update.permanent}}
                                                <div class="blockActive">
                                                    <button type="action" class="majAscension"
                                                        data-permanent="{{this.system.passives.capacites.ascension.update.permanent}}"
                                                        data-prestige="{{this.system.passives.capacites.ascension.update.prestige}}">
                                                        {{localize 'KNIGHT.CAPACITEULTIME.PASSIVE.ASCENSION.Maj'}}
                                                    </button>
                                                </div>
                                                {{/if}}
                                            {{/if}}
                                        {{/if}}
                                    {{/if}}
                                    {{#if (isValue this.system.type 'active')}}
                                        <div class="blockActive">
                                            {{#if this.system.actives.isActivable}}
                                            <button type="action" class="activateCU
                                            {{#if this.system.actives.degats.actif}}
                                            {{#unless this.system.actives.degats.isfixe}}
                                            {{#if this.system.actives.degats.variable.paliers}}
                                            borderBottom
                                            {{/if}}
                                            {{/unless}}
                                            {{/if}}
                                            {{#if this.system.actives.violence.actif}}
                                            {{#unless this.system.actives.violence.isfixe}}
                                            {{#if this.system.actives.violence.variable.paliers}}
                                            borderBottom
                                            {{/if}}
                                            {{/unless}}
                                            {{/if}}
                                            {{#if this.system.actives.jet.actif}}
                                            {{#unless this.system.actives.jet.isfixe}}
                                            {{#if this.system.actives.jet.caracteristiques}}
                                            borderBottom
                                            {{/if}}
                                            {{/unless}}
                                            {{/if}}
                                            "
                                                data-label="{{this.name}}"
                                                data-id="{{this._id}}"
                                                data-toupdate="active"
                                                data-value="{{this.system.active}}"
                                                data-isinstant="{{this.system.actives.instant}}">
                                                {{#unless this.system.active}}
                                                    {{localize 'KNIGHT.AUTRE.Activer'}}
                                                {{else}}
                                                    {{localize 'KNIGHT.AUTRE.Desactiver'}}
                                                {{/unless}}
                                            </button>
                                            {{/if}}

                                            {{#if this.system.actives.jet.actif}}
                                                {{#unless this.system.actives.jet.isfixe}}
                                                    {{#if this.system.actives.jet.variable.caracteristiques}}
                                                    <div class="blockRoll">
                                                        {{#each this.system.actives.jet.variable.caracteristiques}}
                                                            <button type="action" class="rollCU"
                                                                data-label="{{@root/actor/capaciteultime/name}}"
                                                                data-id="{{@root/actor/capaciteultime/_id}}"
                                                                data-type="jet"
                                                                data-caracteristique="{{this}}"
                                                                data-paliers=",">

                                                                {{localize 'KNIGHT.JETS.Label'}} : {{getCarac this}}
                                                            </button>
                                                        {{/each}}
                                                    </div>
                                                    {{/if}}
                                                {{/unless}}
                                            {{/if}}

                                            {{#if this.system.actives.degats.actif}}
                                                {{#unless this.system.actives.degats.isfixe}}
                                                    {{#if this.system.actives.degats.variable.paliers}}
                                                    <div class="blockDgts">
                                                        <button type="action" class="rollCU"
                                                            data-label="{{this.name}}"
                                                            data-id="{{this._id}}"
                                                            data-paliers="{{this.system.actives.degats.variable.paliers}}"
                                                            data-type="degats"
                                                            data-rollCU="dgtsCUList">

                                                            {{localize 'KNIGHT.AUTRE.Degats'}} :
                                                        </button>
                                                        <select class="dgtsCUList">
                                                        {{#each this.system.actives.degats.variable.paliers}}
                                                            <option value="{{@index}}">{{this}}</option>
                                                        {{/each}}
                                                        </select>
                                                    </div>
                                                    {{/if}}
                                                {{/unless}}
                                            {{/if}}

                                            {{#if this.system.actives.violence.actif}}
                                                {{#unless this.system.actives.violence.isfixe}}
                                                    {{#if this.system.actives.violence.variable.paliers}}
                                                    <div class="blockDgts">
                                                        <button type="action" class="rollCU"
                                                            data-label="{{this.name}}"
                                                            data-id="{{this._id}}"
                                                            data-paliers="{{this.system.actives.violence.variable.paliers}}"
                                                            data-type="violence"
                                                            data-rollCU="violCUList">

                                                            {{localize 'KNIGHT.AUTRE.Violence'}} :
                                                        </button>
                                                        <select class="violCUList">
                                                        {{#each this.system.actives.violence.variable.paliers}}
                                                            <option value="{{@index}}">{{this}}</option>
                                                        {{/each}}
                                                        </select>
                                                    </div>
                                                    {{/if}}
                                                {{/unless}}
                                            {{/if}}
                                        </div>
                                    {{/if}}
                                {{/with}}
                            {{/if}}

                            <a class="item-edit" title="Edit Item"><i class="fas fa-edit"></i></a>
                            <a class="item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
                        </h2>
                        <span class="description">{{{actor.capaciteultime.system.description}}}</span>
                    </div>
                    {{/if}}

                    <div class="overdrives">
                        <h2 class="header js-toggler">
                            <i class="far fa-minus-square"></i>
                            {{localize "KNIGHT.ITEMS.ARMURE.Overdrives"}}
                        </h2>

                        {{#each actor.overdrives as | kAspect aspect|}}
                            {{#each kAspect as | kCarac carac|}}
                                <div class="data">
                                    <h3 class="header js-toggler">
                                        <i class="far fa-plus-square"></i>

                                        {{getCarac carac}}
                                    </h3>
                                    <h4 style="display:none;">{{kCarac.titre}}</h4>
                                    {{#each kCarac.liste as | key od|}}
                                        <div class="line" style="display:none;">
                                            <span class="label">{{key.value}}</span>
                                            <span class="description">{{{key.description}}}</span>
                                        </div>
                                    {{/each}}
                                </div>
                            {{/each}}
                        {{/each}}
                    </div>
                </div>

                <div class="tab-armure MAmodule {{#if systemData.MATabs.MAmodule}}active{{/if}}">
                    <div class="slots">
                        <h2 class="header js-toggler">
                            <i class="far fa-minus-square"></i>
                            {{localize "KNIGHT.ITEMS.ARMURE.SLOTS.Label"}}
                        </h2>

                        <div class="line">
                            <div class="block {{#if (isNegative actor.armureData.system.slots.tete.value systemData.equipements.armure.slots.tete)}}red{{/if}}">
                                <span class="title">{{localize "KNIGHT.ITEMS.ARMURE.SLOTS.Tete"}}</span>
                                <span class="score">
                                    {{systemData.equipements.armure.slots.tete}} / {{actor.armureData.system.slots.tete.value}}
                                </span>
                            </div>

                            <div class="block {{#if (isNegative actor.armureData.system.slots.brasGauche.value systemData.equipements.armure.slots.brasGauche)}}red{{/if}}">
                                <span class="title">{{localize "KNIGHT.ITEMS.ARMURE.SLOTS.BrasGauche"}}</span>
                                <span class="score">
                                    {{systemData.equipements.armure.slots.brasGauche}} / {{actor.armureData.system.slots.brasGauche.value}}
                                </span>
                            </div>

                            <div class="block {{#if (isNegative actor.armureData.system.slots.brasDroit.value systemData.equipements.armure.slots.brasDroit)}}red{{/if}}">
                                <span class="title">{{localize "KNIGHT.ITEMS.ARMURE.SLOTS.BrasDroit"}}</span>
                                <span class="score">
                                    {{systemData.equipements.armure.slots.brasDroit}} / {{actor.armureData.system.slots.brasDroit.value}}
                                </span>
                            </div>

                            <div class="block {{#if (isNegative actor.armureData.system.slots.torse.value systemData.equipements.armure.slots.torse)}}red{{/if}}">
                                <span class="title">{{localize "KNIGHT.ITEMS.ARMURE.SLOTS.Torse"}}</span>
                                <span class="score">
                                    {{systemData.equipements.armure.slots.torse}} / {{actor.armureData.system.slots.torse.value}}
                                </span>
                            </div>

                            <div class="block {{#if (isNegative actor.armureData.system.slots.jambeGauche.value systemData.equipements.armure.slots.jambeGauche)}}red{{/if}}">
                                <span class="title">{{localize "KNIGHT.ITEMS.ARMURE.SLOTS.JambeGauche"}}</span>
                                <span class="score">
                                    {{systemData.equipements.armure.slots.jambeGauche}} / {{actor.armureData.system.slots.jambeGauche.value}}
                                </span>
                            </div>

                            <div class="block {{#if (isNegative actor.armureData.system.slots.jambeDroite.value systemData.equipements.armure.slots.jambeDroite)}}red{{/if}}">
                                <span class="title">{{localize "KNIGHT.ITEMS.ARMURE.SLOTS.JambeDroite"}}</span>
                                <span class="score">
                                    {{systemData.equipements.armure.slots.jambeDroite}} / {{actor.armureData.system.slots.jambeDroite.value}}
                                </span>
                            </div>
                        </div>
                    </div>

                    <div class="modules item-list">
                        <h2 class="header js-toggler">
                            <i class="far fa-minus-square"></i>
                            {{localize "KNIGHT.ITEMS.MODULE.Label"}}

                            <a class="item-control item-create" title="Create Item" data-type="module"><i class="fas fa-plus"></i></a>
                        </h2>

                        {{#each actor.modules as | key module|}}
                            {{~> systems/knight/templates/actors/subtab/modules.html key=key}}
                        {{/each}}
                    </div>
                </div>

                <div class="tab-armure MAia {{#if systemData.MATabs.MAia}}active{{/if}}">
                    <div class="ia">
                        <div class="col">
                            <div class="data">
                                <h2>{{localize "KNIGHT.IA.IDENTITE.Label"}}</h2>
                                <label class="middle">
                                    <span>{{localize "KNIGHT.IA.IDENTITE.Code"}}</span>
                                    <input type="text" name="system.equipements.ia.code" value="{{systemData.equipements.ia.code}}" />
                                </label>
                                <label class="middle">
                                    <span>{{localize "KNIGHT.Surnom"}}</span>
                                    <input type="text" name="system.equipements.ia.surnom" value="{{systemData.equipements.ia.surnom}}" />
                                </label>
                            </div>

                            <div class="avantages item-list">
                                <h2 class="header">
                                    {{localize "KNIGHT.PERSONNAGE.Avantages"}}
                                    <a class="item-control item-create" title="Create Item" data-type="avantage" data-subtype="ia"><i class="fas fa-plus"></i></a>
                                </h2>
                                {{#each actor.avantagesIA as | key avantages|}}
                                <div class="block item" data-item-id="{{key._id}}">
                                    <header class="summary header js-toggler" data-item-id="{{key._id}}">
                                        <i class="far fa-plus-square extendButton"></i>
                                        <div class="gestionButton">
                                            <a class="avdvshow" data-value="{{key.system.show}}" title="{{#if key.system.show}}{{KNIGHT.IA.MasqueAvantage}}{{else}}{{KNIGHT.IA.MonstrerAvantage}}{{/if}}">
                                            {{#if key.system.show}}
                                                <i class="fa-solid fa-eye"></i>
                                            {{else}}
                                                <i class="fa-solid fa-eye-slash"></i>
                                            {{/if}}
                                            </a>
                                            <a class="item-control item-edit" title="Edit Item"><i class="fas fa-edit"></i></a>
                                            <a class="item-control item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
                                        </div>
                                        <span>{{key.name}}</span>
                                    </header>
                                    <span class="description">
                                        {{{key.system.description}}}
                                    </span>
                                </div>
                                {{/each}}
                            </div>
                        </div>

                        <div class="col">
                            <div class="data">
                                <div class="description">
                                    <h2>{{localize "KNIGHT.IA.Caractere"}}</h2>
                                    {{editor systemData.equipements.ia.caractere target="system.equipements.ia.caractere" button=true owner=owner editable=editable}}
                                </div>
                            </div>

                            <div class="inconvenients item-list">
                                <h2 class="header">
                                    {{localize "KNIGHT.PERSONNAGE.Inconvenient"}}
                                    <a class="item-control item-create" title="Create Item" data-type="inconvenient" data-subtype="ia"><i class="fas fa-plus"></i></a>
                                </h2>
                                {{#each actor.inconvenientIA as | key inconvenient|}}
                                <div class="block item" data-item-id="{{key._id}}">
                                    <header class="summary header js-toggler" data-item-id="{{key._id}}">
                                        <i class="far fa-plus-square extendButton"></i>
                                        <div class="gestionButton">
                                            <a class="avdvshow" data-value="{{key.system.show}}" title="{{#if key.system.show}}{{KNIGHT.IA.MasqueAvantage}}{{else}}{{KNIGHT.IA.MonstrerAvantage}}{{/if}}">
                                            {{#if key.system.show}}
                                                <i class="fa-solid fa-eye"></i>
                                            {{else}}
                                                <i class="fa-solid fa-eye-slash"></i>
                                            {{/if}}
                                            </a>
                                            <a class="item-control item-edit" title="Edit Item"><i class="fas fa-edit"></i></a>
                                            <a class="item-control item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
                                        </div>
                                        <span>{{key.name}}</span>
                                    </header>
                                    <span class="description">
                                        {{{key.system.description}}}
                                    </span>
                                </div>
                                {{/each}}
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>

        <div class="tab combat" data-group="primary" data-tab="combat">
            <div class="main">
                <div class="armesContact">
                    <div class="block item-list">
                        <h2 class="header">
                            {{localize "KNIGHT.COMBAT.ARMES.CONTACT.Label"}}
                            <a class="item-control item-create" title="Create Item" data-type="arme" data-subtype="contact"><i class="fas fa-plus"></i></a>
                        </h2>

                        {{#each actor.armesContactEquipee as | key arme|}}
                            {{~> systems/knight/templates/actors/subtab/armes.html equipped=true num=arme}}
                        {{/each}}
                    </div>

                    <div class="block item-list">
                        <h3 class="header">
                            {{localize "KNIGHT.COMBAT.ARMES.Rack"}}
                        </h3>

                        {{#each actor.armesContactRack as | key arme|}}
                            {{~> systems/knight/templates/actors/subtab/armes.html}}
                        {{/each}}
                    </div>

                    <div class="block item-list">
                        <h3 class="header">
                            {{localize "KNIGHT.COMBAT.ARMES.Armoury"}}
                        </h3>

                        {{#each actor.armesContactArmoury as | key arme|}}
                            {{~> systems/knight/templates/actors/subtab/armes.html}}
                        {{/each}}
                    </div>
                </div>

                {{#unless systemData.restrictions.noArmeDistance}}
                    <div class="armesDistance">
                        <div class="block item-list">
                            <h2 class="header">
                                {{localize "KNIGHT.COMBAT.ARMES.DISTANCE.Label"}}
                                <a class="item-control item-create" title="Create Item" data-type="arme" data-subtype="distance"><i class="fas fa-plus"></i></a>
                            </h2>

                            {{#if actor.longbow.has}}
                                {{~> systems/knight/templates/actors/subtab/longbow.html actor.longbow}}
                            {{/if}}

                            {{#each actor.armesDistanceEquipee as | key arme|}}
                                {{~> systems/knight/templates/actors/subtab/armes.html equipped=true num=arme}}
                            {{/each}}
                        </div>

                        <div class="block item-list">
                            <h3 class="header">
                                {{localize "KNIGHT.COMBAT.ARMES.Rack"}}
                            </h3>

                            {{#each actor.armesDistanceRack as | key arme|}}
                                {{~> systems/knight/templates/actors/subtab/armes.html}}
                            {{/each}}
                        </div>

                        <div class="block item-list">
                            <h3 class="header">
                                {{localize "KNIGHT.COMBAT.ARMES.Armoury"}}
                            </h3>

                            {{#each actor.armesDistanceArmoury as | key arme|}}
                                {{~> systems/knight/templates/actors/subtab/armes.html}}
                            {{/each}}
                        </div>
                    </div>
                {{/unless}}
            </div>

            <div class="main">
                <div class="armesImprovisees">
                    <h2 class="header js-toggler">
                        <i class="far fa-minus-square"></i>
                        {{localize "KNIGHT.COMBAT.ARMESIMPROVISEES.LabelContact"}}
                    </h2>
                    {{#each systemData.combat.armesimprovisees.liste as | kAI armesimprovisees|}}
                        <div class="block">
                            <h3 class="header js-toggler">
                                <i class="far fa-plus-square"></i>
                                {{localize "KNIGHT.COMBAT.ARMESIMPROVISEES.ODForce"}} : {{kAI.force}}
                            </h3>
                            {{#each kAI.liste as | key arme|}}
                                <div class="wpn" style="display:none;">
                                    <span class="name">
                                        {{getAI armesimprovisees arme}}
                                    </span>
                                    <div class="line">
                                        <div class="doubleLine">
                                            <span class="header">{{localize "KNIGHT.AUTRE.Degats"}}</span>
                                            <span>{{key.degats.dice}}{{localize "KNIGHT.JETS.Des-short"}}6</span>
                                        </div>
                                        <div class="doubleLine">
                                            <span class="header">{{localize "KNIGHT.AUTRE.Violence"}}</span>
                                            <span>{{key.violence.dice}}{{localize "KNIGHT.JETS.Des-short"}}6</span>
                                        </div>

                                        <img src="systems/knight/assets/icons/D6Black.svg" class="dice jetWpn"
                                        data-id="contact"
                                        data-name="{{armesimprovisees}}"
                                        data-isDistance="armesimprovisees"
                                        data-num="{{arme}}" data-caracteristiques="{{@root/systemData/combat/armesimprovisees/contact}},force" />
                                    </div>
                                </div>
                            {{/each}}
                        </div>
                    {{/each}}
                </div>

                <div class="armesImprovisees">
                    <h2 class="header  js-toggler">
                        <i class="far fa-minus-square"></i>
                        {{localize "KNIGHT.COMBAT.ARMESIMPROVISEES.LabelDistance"}}
                    </h2>
                    {{#each systemData.combat.armesimprovisees.liste as | kAI armesimprovisees|}}
                        <div class="block">
                            <h3 class="header js-toggler">
                                <i class="far fa-plus-square"></i>
                                {{localize "KNIGHT.COMBAT.ARMESIMPROVISEES.ODForce"}} : {{kAI.force}}
                            </h3>
                            {{#each kAI.liste as | key arme|}}
                                <div class="wpn" style="display:none;">
                                    <span class="name">
                                        {{getAI armesimprovisees arme}}
                                    </span>
                                    <div class="line">
                                        <div class="doubleLine">
                                            <span class="header">{{localize "KNIGHT.AUTRE.Degats"}}</span>
                                            <span>{{key.degats.dice}}{{localize "KNIGHT.JETS.Des-short"}}6</span>
                                        </div>
                                        <div class="doubleLine">
                                            <span class="header">{{localize "KNIGHT.AUTRE.Violence"}}</span>
                                            <span>{{key.violence.dice}}{{localize "KNIGHT.JETS.Des-short"}}6</span>
                                        </div>

                                        <img src="systems/knight/assets/icons/D6Black.svg" class="dice jetWpn"
                                        data-id="distance"
                                        data-name="{{armesimprovisees}}"
                                        data-isDistance="armesimprovisees" data-num="{{arme}}"
                                        data-caracteristiques="{{@root/systemData/combat/armesimprovisees/distance}},force" />
                                    </div>
                                </div>
                            {{/each}}
                        </div>
                    {{/each}}
                </div>
            </div>

            <div class="main">
                {{#unless (ascension systemData.wear)}}
                <div class="grenades">
                    <h2 class="header js-toggler">
                        <i class="far fa-minus-square"></i>
                        {{localize "KNIGHT.COMBAT.GRENADES.Label"}}
                        <div class="headerQuantity">
                            <input type="number" name="system.combat.grenades.quantity.value" value="{{systemData.combat.grenades.quantity.value}}" min="0" max="{{systemData.combat.grenades.quantity.max}}" />
                            <span>/</span>
                            <input type="number" name="system.combat.grenades.quantity.max" value="{{systemData.combat.grenades.quantity.max}}" min="0"  />
                        </div>
                    </h2>

                    <button type="action" class="recover" data-type="grenades" data-max="{{systemData.combat.grenades.quantity.max}}">{{localize "KNIGHT.RECUPERER.Grenades"}}</button>

                    {{#each systemData.combat.grenades.liste as | key grenades|}}
                    <div class="line">
                        <span class="label">{{getGrenadeName grenades}}</span>
                        <div class="effets">
                            {{#each key.effets.liste as | keyEffet effet|}}
                            <div class="effetNormal">
                                <span class="label">{{keyEffet.name}}</span>
                                <img class="info" src="systems/knight/assets/icons/info.svg" />
                                <span class="hideInfo">{{{getEffetsDescription keyEffet.description}}}</span>
                            </div>
                            {{/each}}
                        </div>

                        <div class="blockRoll">
                            <img src="systems/knight/assets/icons/D6Black.svg" class="dice jetWpn" data-name="{{grenades}}" data-id="" data-isDistance="grenades" data-num="" />
                        </div>
                    </div>
                    {{/each}}
                </div>
                {{/unless}}

                <div class="col">
                    {{#unless systemData.restrictions.noArmeDistance}}
                        <div class="armesDistance wpnTourelle">
                            <div class="block item-list">
                                <h2 class="header">
                                    {{localize "KNIGHT.COMBAT.ARMES.TOURELLE.Label"}}
                                    <a class="item-control item-create" title="Create Item" data-type="arme" data-subtype="distance" data-tourelle="true"><i class="fas fa-plus"></i></a>
                                </h2>

                                {{#each actor.armesTourelles as | key arme|}}
                                    {{~> systems/knight/templates/actors/subtab/armes.html equipped=true num=arme}}
                                {{/each}}
                            </div>
                        </div>
                    {{/unless}}

                    <div class="nods">
                        <h2 class="header">
                            {{localize "KNIGHT.COMBAT.NODS.Label"}}
                        </h2>

                        {{#each systemData.combat.nods as | key nods|}}
                        <div class="line">
                            <span class="label">{{getNodsName nods}}</span>
                            <div class="blockQuantite">
                                <input type="number" name="system.combat.nods.{{nods}}.value" value="{{key.value}}" max="{{key.max}}"  />
                                <span>/</span>
                                <input type="number" name="system.combat.nods.{{nods}}.max" value="{{key.max}}" />
                            </div>
                            <div class="blockRoll">
                                <img src="systems/knight/assets/icons/D6Black.svg" title='{{localize "KNIGHT.COMBAT.NODS.SoiMeme"}}' class="dice"
                                    data-nods="{{nods}}" data-number="{{key.value}}" />
                                <img src="systems/knight/assets/icons/D6TargetBlack.svg" title='{{localize "KNIGHT.COMBAT.NODS.Autrui"}}' class="diceTarget"
                                    data-nods="{{nods}}" data-number="{{key.value}}" />
                            </div>
                        </div>
                        {{/each}}
                        <button type="action" class="recover" data-type="nods" data-list="{{#each systemData.combat.nods as | key nods|}}{{nods}}-{{key.max}}{{#unless @last}}/{{/unless}}{{/each}}">{{localize "KNIGHT.RECUPERER.Nods"}}</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="tab historique" data-group="primary" data-tab="historique">
            <div class="main">
                <div class="langues item-list">
                    <h2 class="header">
                        {{localize "KNIGHT.HISTORIQUE.Langues"}}
                        <a class="item-control item-create" title="Create Item" data-type="langue"><i class="fas fa-plus"></i></a>
                        <span class="headerScore">{{systemData.langues.value}}</span>
                    </h2>
                    {{#each actor.langue as | key langue|}}
                    <div class="block item" data-item-id="{{key._id}}">
                        <header class="summary" data-item-id="{{key._id}}">
                            <div class="gestionButton">
                                <a class="item-control item-edit" title="Edit Item"><i class="fas fa-edit"></i></a>
                                <a class="item-control item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
                            </div>
                            <span>{{key.name}}</span>
                        </header>
                    </div>
                    {{/each}}
                </div>

                <div class="contacts item-list">
                    <h2 class="header">
                        {{localize "KNIGHT.HISTORIQUE.Contacts"}}
                        <a class="item-control item-create" title="Create Item" data-type="contact"><i class="fas fa-plus"></i></a>
                        <span class="headerScore">{{systemData.contacts.value}}</span>

                    </h2>
                    {{#each actor.contact as | key contact|}}
                    <div class="block item" data-item-id="{{key._id}}">
                        <header class="summary js-toggler" data-item-id="{{key._id}}">
                            <i class="far fa-plus-square extendButton"></i>
                            <div class="gestionButton">
                                <a class="item-control item-edit" title="Edit Item"><i class="fas fa-edit"></i></a>
                                <a class="item-control item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
                            </div>
                            <span>{{key.name}}</span>
                        </header>
                        <span class="description">
                            {{{key.system.description}}}
                        </span>
                    </div>
                    {{/each}}
                </div>

                <div class="blessures item-list">
                    <h2 class="header">
                        {{localize "KNIGHT.HISTORIQUE.Blessures"}}
                        <a class="item-control item-create" title="Create Item" data-type="blessure"><i class="fas fa-plus"></i></a>
                    </h2>
                    {{#each actor.blessure as | key blessure|}}
                    <div class="block item" data-item-id="{{key._id}}">
                        <header class="summary js-toggler" data-item-id="{{key._id}}">
                            <i class="far fa-plus-square extendButton"></i>
                            <div class="gestionButton">
                                <a class="item-control item-edit" title="Edit Item"><i class="fas fa-edit"></i></a>
                                <a class="item-control item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
                            </div>
                            <span>{{key.name}}</span>
                        </header>
                        <span class="description">
                            {{{key.system.description}}}
                        </span>
                    </div>
                    {{/each}}
                </div>

                <div class="traumas item-list">
                    <h2 class="header">
                        {{localize "KNIGHT.HISTORIQUE.Traumas"}}
                        <a class="item-control item-create" title="Create Item" data-type="trauma"><i class="fas fa-plus"></i></a>
                    </h2>
                    {{#each actor.trauma as | key trauma|}}
                    <div class="block item" data-item-id="{{key._id}}">
                        <header class="summary js-toggler" data-item-id="{{key._id}}">
                            <i class="far fa-plus-square extendDescriptionButton"></i>
                            <div class="gestionButton">
                                <a class="item-control item-edit" title="Edit Item"><i class="fas fa-edit"></i></a>
                                <a class="item-control item-delete" title="Delete Item"><i class="fas fa-trash"></i></a>
                            </div>
                            <span>{{key.name}}</span>
                        </header>
                        {{#unless key.system.gainEspoir.applique}}
                        <button type="action" class="gainEspoirItem" data-id="{{key._id}}">{{localize "KNIGHT.ITEMS.BLESSURETRAUMA.AppliquerGain"}}</button>
                        {{/unless}}
                        <span class="description">
                            {{{key.system.description}}}
                        </span>
                    </div>
                    {{/each}}
                </div>
            </div>

            <div class="histoire">
                <h2 class="header">{{localize "KNIGHT.HISTORIQUE.Histoire"}}</h2>

                {{editor systemData.histoire target="system.histoire" button=true owner=owner editable=editable}}
            </div>
        </div>

        <div class="tab progression" data-group="primary" data-tab="progression">
            <div class="main">
                <div class="dataExperience">
                    <h2 class="header">
                        {{localize "KNIGHT.PROGRESSION.EXPERIENCE.Label"}}
                    </h2>
                    <label>
                        <span class="label">
                            {{localize "KNIGHT.PROGRESSION.Actuel"}}
                        </span>
                        <input type="number" name="system.progression.experience.actuel" value="{{systemData.progression.experience.actuel}}" />
                    </label>
                    <label>
                        <span class="label">
                            {{localize "KNIGHT.PROGRESSION.Utilise"}}
                        </span>
                        <span class="score">
                            {{systemData.progression.experience.depense.total}}
                        </span>
                    </label>
                    <label>
                        <span class="label">
                            {{localize "KNIGHT.AUTRE.Total"}}
                        </span>
                        <span class="score">
                            {{systemData.progression.experience.total}}
                        </span>
                    </label>
                </div>

                <div class="dataPG">
                    <h2 class="header">
                        {{localize "KNIGHT.PROGRESSION.GLOIRE.Label"}}
                    </h2>
                    <label>
                        <span class="label">
                            {{localize "KNIGHT.PROGRESSION.Actuel"}}
                        </span>
                        <input type="number" name="system.progression.gloire.actuel" value="{{systemData.progression.gloire.actuel}}" />
                    </label>
                    <label>
                        <span class="label">
                            {{localize "KNIGHT.PROGRESSION.Utilise"}}
                        </span>
                        <span class="score">
                            {{#if systemData.progression.gloire.depense.total}}
                                {{systemData.progression.gloire.depense.total}}
                                {{else}}
                                0
                            {{/if}}
                        </span>
                    </label>
                    <label>
                        <span class="label">
                            {{localize "KNIGHT.AUTRE.Total"}}
                        </span>
                        <span class="score">
                            {{#if systemData.progression.gloire.total}}
                                {{systemData.progression.gloire.total}}
                                {{else}}
                                0
                            {{/if}}
                        </span>
                    </label>
                </div>

                {{#unless (isEmpty actor.evolutionsAAcheter)}}
                <div class="evolutionsAAcheter">
                    {{#each actor.evolutionsAAcheter as | key evolution|}}
                    <button class="acheter-evolution-longbow" data-id="{{key.id}}" data-value="{{key.value}}" title="{{key.description}}">
                        {{localize "KNIGHT.PROGRESSION.AcheterEvolutionLongbow"}} : {{key.value}}{{localize "KNIGHT.AUTRE.PointGloire-short"}}
                        <span class="hideInfo">{{{getEffetsDescription key.description}}}</span>
                    </button>
                    {{/each}}
                </div>
                {{/unless}}

                <div class="tableauPG">
                    <h2 class="header js-toggler">
                        <i class="far fa-minus-square"></i>
                        {{localize "KNIGHT.PROGRESSION.GLOIRE.ListeDepense"}}
                        <a class="gloire-create" title="Create Item"><i class="fas fa-plus"></i></a>
                    </h2>
                    <div class="lineHeader">
                        <span class="label">{{localize "KNIGHT.Nom"}}</span>
                        <span class="value">{{localize "KNIGHT.PROGRESSION.Cout"}}</span>
                        <span class="last"></span>
                    </div>
                    {{#each systemData.progression.gloire.depense.liste as | key depense|}}
                    <div class="line">
                        {{#unless key.isEmpty}}
                            {{#unless key.isArmure}}
                                {{#if key.isAcheter}}
                                <div class="acheter">
                                    <span class="label">{{localize "KNIGHT.PROGRESSION.EvolutionArmure"}}</span>
                                    <span class="value">{{key.value}}{{localize "KNIGHT.AUTRE.PointGloire-short"}}</span>
                                    <button type="action" data-value="{{key.gratuit}}" data-longbow="true" data-evo="{{key.evo}}" data-id="{{key.id}}" class="{{#if key.gratuit}}selected{{else}}unselected{{/if}}">
                                        {{#if key.gratuit}}
                                            {{localize "KNIGHT.PROGRESSION.Gratuit"}}
                                        {{else}}
                                            {{localize "KNIGHT.PROGRESSION.Payant"}}
                                        {{/if}}
                                    </button>
                                </div>
                                {{else}}
                                    {{#if key.isAutre}}
                                        <div class="autre">
                                            <a class="gloire-delete" title="Delete Item" data-id="{{key.id}}"><i class="fas fa-trash"></i></a>
                                            <input type="hidden" name="system.progression.gloire.depense.autre.{{key.id}}.order" value="{{getOtherListPG key.id 'order' @root/data/system 'number'}}" />
                                            <input type="hidden" name="system.progression.gloire.depense.autre.{{key.id}}.gratuit" value="{{getOtherListPG key.id 'gratuit' @root/data/system 'bool'}}" />
                                            <input type="text" name="system.progression.gloire.depense.autre.{{key.id}}.nom" value="{{getOtherListPG key.id 'nom' @root/data/system 'text'}}"/>
                                            <div class="pg">
                                                <input type="number" name="system.progression.gloire.depense.autre.{{key.id}}.cout" value="{{getOtherListPG key.id 'cout' @root/data/system 'number'}}"/>
                                                <span class="value">{{localize "KNIGHT.AUTRE.PointGloire-short"}}</span>
                                            </div>
                                            <span class="btn"></span>
                                        </div>
                                        {{else}}
                                        <span class="label">{{key.name}}</span>
                                        <span class="value">{{key.value}}{{localize "KNIGHT.AUTRE.PointGloire-short"}}</span>
                                        <button type="action" data-value="{{key.gratuit}}" data-id="{{key.id}}" data-isModule="{{key.isModule}}" data-niveau="{{key.niveau}}" class="{{#if key.gratuit}}selected{{else}}unselected{{/if}}">
                                            {{#if key.gratuit}}
                                                {{localize "KNIGHT.PROGRESSION.Gratuit"}}
                                            {{else}}
                                                {{localize "KNIGHT.PROGRESSION.Payant"}}
                                            {{/if}}
                                        </button>
                                    {{/if}}
                                {{/if}}
                            {{else}}
                            <div class="armure">
                                <span class="label">{{localize "KNIGHT.PROGRESSION.EvolutionArmure"}}</span>
                                <span class="value">{{key.value}}{{localize "KNIGHT.AUTRE.PointGloire-short"}}</span>
                            </div>
                            {{/unless}}
                        {{/unless}}
                    </div>
                    {{/each}}
                </div>

                <div class="tableauPX">
                    <h2 class="header js-toggler">
                        <i class="far fa-minus-square"></i>
                        {{localize "KNIGHT.PROGRESSION.EXPERIENCE.ListeDepense"}}
                        <a class="experience-create" title="Create Item"><i class="fas fa-plus"></i></a>
                    </h2>
                    <div class="lineHeader">
                        <span class="label">{{localize "KNIGHT.Nom"}}</span>
                        <span class="value">{{localize "KNIGHT.BONUS.Label"}}</span>
                        <span class="value">{{localize "KNIGHT.PROGRESSION.Cout"}}</span>
                    </div>
                    {{#each systemData.progression.experience.depense.liste as | key depense|}}
                    <div class="line">
                        <a class="experience-delete" title="Delete Item" data-id="{{depense}}"><i class="fas fa-trash"></i></a>
                        <select name="system.progression.experience.depense.liste.{{depense}}.nom">
                            {{#select key.nom}}
                                <option value=""></option>
                                <option value="autre">{{localize "KNIGHT.AUTRE.Label"}}</option>
                                <option value="capaciteheroique">{{localize "KNIGHT.HEROISME.CAPACITE.Label"}}</option>
                                {{#each @root/systemData/aspects as | key aspect|}}
                                    <option value="{{aspect}}">{{getAspect aspect}}</option>
                                    {{#each key.caracteristiques as | keyCarac caracteristique|}}
                                        <option value="{{caracteristique}}">{{localize "KNIGHT.ITEMS.Caracteristique"}} : {{getCarac caracteristique}}</option>
                                    {{/each}}
                                {{/each}}
                            {{/select}}
                        </select>
                        {{#if (isValue key.nom 'capaciteheroique')}}
                        <span class="value"></span>
                        {{else}}
                            {{#if (isValue key.nom 'autre')}}
                            <span class="value"></span>
                            {{else}}
                            <input type="number" name="system.progression.experience.depense.liste.{{depense}}.bonus" value="{{key.bonus}}" min="0" />
                            {{/if}}
                        {{/if}}
                        <input type="number" name="system.progression.experience.depense.liste.{{depense}}.cout" value="{{key.cout}}" min="0" />
                    </div>
                    {{/each}}
                </div>
            </div>
        </div>

        <div class="tab options" data-group="primary" data-tab="options">
            <div class="main">
                {{#if systemData.jauges.sante}}
                <button type="action" class="recover unselected" data-type="sante" data-max="{{systemData.sante.max}}">{{localize "KNIGHT.RECUPERER.Sante"}}</button>
                {{/if}}

                {{#if systemData.jauges.armure}}
                <button type="action" class="recover unselected" data-type="armure" data-max="{{systemData.armure.max}}">{{localize "KNIGHT.RECUPERER.Armure"}}</button>
                {{/if}}

                {{#if systemData.jauges.energie}}
                <button type="action" class="recover unselected" data-type="energie" data-max="{{systemData.energie.max}}">{{localize "KNIGHT.RECUPERER.Energie"}}</button>
                {{/if}}

                {{#if systemData.jauges.espoir}}
                <button type="action" class="recover unselected" data-type="espoir" data-max="{{systemData.espoir.max}}">{{localize "KNIGHT.RECUPERER.Espoir"}}</button>
                {{/if}}

                <button type="action" data-value="{{systemData.options.kraken}}" data-option="kraken" class="{{#if systemData.options.kraken}}selected{{else}}unselected{{/if}}">
                    {{#if systemData.options.kraken}}
                        {{localize "KNIGHT.OPTIONS.KRAKEN.Has"}}
                    {{else}}
                        {{localize "KNIGHT.OPTIONS.KRAKEN.Hasnt"}}
                    {{/if}}
                </button>

                <button type="action" data-value="{{systemData.options.art}}" data-option="art" class="{{#if systemData.options.art}}selected{{else}}unselected{{/if}}">
                    {{#if systemData.options.art}}
                        {{localize "KNIGHT.OPTIONS.ART.Has"}}
                    {{else}}
                        {{localize "KNIGHT.OPTIONS.ART.Hasnt"}}
                    {{/if}}
                </button>

                {{#if (hasCapacite this 'warlord')}}
                    <button type="action" class="unselected" data-option="resetwarlord">
                        {{localize "KNIGHT.ROLLBACK.Resetwarlord"}}
                    </button>
                {{/if}}

                {{#if (hasCapacite this 'type')}}
                    <button type="action" class="unselected" data-option="resettype">
                        {{localize "KNIGHT.ROLLBACK.Resettype"}}
                    </button>
                {{/if}}

                <div class="rollback">
                    <h2 class="header">
                        {{localize "KNIGHT.ROLLBACK.Label"}}
                    </h2>
                    {{#if actor.armureData.system.archivage.liste}}
                        <h3>
                            {{localize "KNIGHT.ROLLBACK.Avantevolution"}}
                        </h3>
                        <span class="notes">{{localize "KNIGHT.ROLLBACK.Notes"}}</span>
                        {{#each actor.armureData.system.archivage.liste as |key data|}}
                        <div class="col">
                            <span class="pg">{{data}}{{localize 'KNIGHT.AUTRE.PointGloire-short'}}</span>
                            <a class="retour" data-value="{{@index}}" data-type="liste">{{localize "KNIGHT.ROLLBACK.Revenir"}}</a>
                        </div>
                        {{/each}}
                    {{/if}}
                    {{#unless (isEmpty actor.armureData.system.archivage.longbow)}}
                        <h3>
                            {{localize "KNIGHT.ROLLBACK.Avantevolutionlongbow"}}
                        </h3>
                        <span class="notes">{{localize "KNIGHT.ROLLBACK.Noteslongbow"}}</span>
                        {{#each actor.armureData.system.archivage.longbow as |key data|}}
                            <div class="col">
                                <span class="pg">{{key.value}}{{localize 'KNIGHT.AUTRE.PointGloire-short'}}</span>
                                <a class="retour" data-value="{{data}}" data-type="longbow">{{localize "KNIGHT.ROLLBACK.Revenir"}}</a>
                                <span class="description">{{key.description}}</span>
                            </div>
                        {{/each}}
                    {{/unless}}
                </div>
            </div>
        </div>
    </section>
</form>
