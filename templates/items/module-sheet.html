<form class="flexcol {{cssClass}}" autocomplete="off">
    <header class="sheet-header">
        <h1 class="charname">
            <input name="name" type="text" value="{{data.name}}" placeholder="{{localize "KNIGHT.Nom"}}" />
        </h1>

        <select name="system.niveau.value" {{#if systemData.noEditLvl}}disabled{{/if}}>
            {{selectOptions (getNiveau systemData.niveau.details) selected=systemData.niveau.value}}
        </select>
    </header>

     <div class="main">
        <div class="blockImg">
            <img class="profile-img" src="{{data.img}}" data-edit="img" title="{{data.name}}" />

            <label>
                <span>{{localize "KNIGHT.ITEMS.MODULE.NombreNiveau"}}</span>
                <input type="number" name="system.niveau.max" value="{{systemData.niveau.max}}" min="1" />
            </label>
            <button type="action" class="nbreniveau" data-value="{{systemData.niveau.max}}">{{localize "KNIGHT.AUTRE.Valider"}}</button>
        </div>

        <div class="description">
            <h2 class="header">{{localize "KNIGHT.Description"}}</h2>

            {{editor systemData.description target="system.description" button=true owner=owner editable=editable}}
        </div>

        <div class="fullData">
            <h2 class="header js-toggler">
                <i class="far fa-minus-square"></i>
                {{localize "KNIGHT.ITEMS.ARMURE.SLOTS.Label"}}
            </h2>
            <div class="line slots">
                <label class="block">
                    <span class="title">{{localize "KNIGHT.ITEMS.ARMURE.SLOTS.Tete"}}</span>
                    <input type="number" name="system.slots.tete" value="{{systemData.slots.tete}}" min="0" />
                </label>

                <label class="block">
                    <span class="title">{{localize "KNIGHT.ITEMS.ARMURE.SLOTS.BrasGauche"}}</span>
                    <input type="number" name="system.slots.brasGauche" value="{{systemData.slots.brasGauche}}" min="0" />
                </label>

                <label class="block">
                    <span class="title">{{localize "KNIGHT.ITEMS.ARMURE.SLOTS.BrasDroit"}}</span>
                    <input type="number" name="system.slots.brasDroit" value="{{systemData.slots.brasDroit}}" min="0" />
                </label>

                <label class="block">
                    <span class="title">{{localize "KNIGHT.ITEMS.ARMURE.SLOTS.Torse"}}</span>
                    <input type="number" name="system.slots.torse" value="{{systemData.slots.torse}}" min="0" />
                </label>

                <label class="block">
                    <span class="title">{{localize "KNIGHT.ITEMS.ARMURE.SLOTS.JambeGauche"}}</span>
                    <input type="number" name="system.slots.jambeGauche" value="{{systemData.slots.jambeGauche}}" min="0" />
                </label>

                <label class="block">
                    <span class="title">{{localize "KNIGHT.ITEMS.ARMURE.SLOTS.JambeDroite"}}</span>
                    <input type="number" name="system.slots.jambeDroite" value="{{systemData.slots.jambeDroite}}" min="0" />
                </label>
            </div>
        </div>

        <div class="col">
            <label class="oneLine">
                <span>{{localize "KNIGHT.ITEMS.MODULE.CATEGORIE.Label"}}</span>
                <select name="system.categorie">
                    {{selectOptions systemData.listes.categorie selected=systemData.categorie blank='' localize=true}}
                </select>
            </label>
        </div>
    </div>

    <section class="body">
        {{!-- Sheet Tab Navigation --}}
        <nav class="sheet-tabs tabs" data-group="primary">
            {{#each systemData.niveau.details as | key nv|}}
                <a class="item" data-tab="niveau_{{nv}}">
                    {{localize "KNIGHT.ITEMS.MODULE.Niveau"}} {{key.label}} {{#if (NiveauisHigherThan nv 1)}} (+{{key.prix}}{{localize "KNIGHT.AUTRE.PointGloire-short"}}) {{/if}}
                    <i class="fa-solid fa-check active"></i>
                </a>
            {{/each}}
        </nav>

        {{#each systemData.niveau.details as | key nv|}}
        <div class="tab niveaux niveau_{{nv}}" data-key="{{nv}}" data-group="primary" data-tab="niveau_{{nv}}">
            <div class="main">
                <div class="col">
                    <label class="twoLine">
                        <span>{{localize "KNIGHT.ACTIVATION.Label"}}</span>
                        <select name="system.niveau.details.{{nv}}.activation">
                            {{selectOptions (getList 'activation') selected=key.activation localize=true}}
                        </select>
                    </label>

                    <div class="twoLine">
                        <button type="action" class="button
                        {{#if key.secondmode.has}}
                        active noBorderBottom
                        {{else}}
                        unactive
                        {{/if}}
                        " data-type="secondmode" data-subtype="has" data-value="{{key.secondmode.has}}">{{key.labels.secondmode}}</button>
                        {{#if key.secondmode.has}}
                            <select name="system.niveau.details.{{nv}}.secondmode.activation">
                            {{selectOptions (getList 'activation') selected=key.secondmode.activation localize=true}}
                        </select>
                        {{/if}}
                    </div>

                    <div class="twoLine">
                        <span>{{localize "KNIGHT.DUREE.Label"}}</span>
                        <button type="action" class="button
                        {{#if key.permanent}}
                        active noBorderBottom
                        {{else}}
                        unactive
                        {{/if}}
                        " data-type="permanent" data-value="{{key.permanent}}">{{key.labels.duree}}</button>
                        <textarea class="{{#if key.permanent}}hidden{{/if}}" data-type="duree" data-min="22" style="height:{{key.textarea.duree}}px;" name="system.niveau.details.{{nv}}.duree">{{key.duree}}</textarea>
                    </div>
                </div>

                <div class="col">
                    <label class="oneLine">
                        <span>{{localize "KNIGHT.ITEMS.MODULE.RARETE.Label"}}</span>
                        <select name="system.niveau.details.{{nv}}.rarete">
                            {{selectOptions key.listes.rarete selected=key.rarete localize=true}}
                        </select>
                    </label>

                    <label class="oneLine">
                        <span>{{localize "KNIGHT.AUTRE.PointGloire"}}</span>
                        <input type="number" name="system.niveau.details.{{nv}}.prix" value="{{key.prix}}" min="0" />
                    </label>

                    <div class="twoLine">
                        <span>
                            {{localize "KNIGHT.LATERAL.Energie"}}
                        </span>
                        <label class="oneLine">
                            <input class="label" type="text" name="system.niveau.details.{{nv}}.energie.tour.label" value="{{key.energie.tour.label}}" />
                            <input type="number" name="system.niveau.details.{{nv}}.energie.tour.value" value="{{key.energie.tour.value}}" min="0" />
                        </label>
                        <label class="oneLine">
                            <input class="label" type="text" name="system.niveau.details.{{nv}}.energie.minute.label" value="{{key.energie.minute.label}}" />
                            <input type="number" name="system.niveau.details.{{nv}}.energie.minute.value" value="{{key.energie.minute.value}}" min="0" />
                        </label>
                        <label class="oneLine">
                            <span>{{localize "KNIGHT.AUTRE.EnergieSupplementaire"}}</span>
                            <input type="number" name="system.niveau.details.{{nv}}.energie.supplementaire" value="{{key.energie.supplementaire}}" min="0" />
                        </label>
                    </div>

                    <label class="oneLine">
                        <span>{{localize "KNIGHT.PORTEE.Label"}}</span>
                        <select name="system.niveau.details.{{nv}}.portee">
                            {{selectOptions (getList 'porteecomplet') selected=key.portee localize=true}}
                        </select>
                    </label>
                </div>
            </div>

            <div class="main">
                <div class="col">
                    <div class="oneLine">
                        <button type="action" class="button
                        {{#if key.bonus.has}}
                        active
                        {{else}}
                        unactive
                        {{/if}}
                        " data-type="bonus" data-subtype="has" data-value="{{key.bonus.has}}">{{key.labels.bonus}}</button>
                    </div>

                    <div class="oneLine">
                        <button type="action" class="button
                        {{#if key.pnj.has}}
                        active
                        {{else}}
                        unactive
                        {{/if}}
                        " data-type="pnj" data-subtype="has" data-value="{{key.pnj.has}}">{{key.labels.pnj}}</button>
                    </div>

                    <div class="oneLine">
                        <button type="action" class="button
                        {{#if key.ersatz.rogue.has}}
                        active
                        {{else}}
                        unactive
                        {{/if}}
                        " data-type="ersatz" data-subtype="rogue" data-name="has" data-value="{{key.ersatz.rogue.has}}">{{key.labels.ersatzRogue}}</button>
                    </div>

                    <div class="oneLine">
                        <button type="action" class="button
                        {{#if key.jetsimple.has}}
                        active
                        {{else}}
                        unactive
                        {{/if}}
                        " data-type="jetsimple" data-subtype="has" data-value="{{key.jetsimple.has}}">{{key.labels.jetSimple}}</button>
                    </div>
                </div>

                <div class="col">
                    <div class="oneLine">
                        <button type="action" class="button
                        {{#if key.arme.has}}
                        active
                        {{else}}
                        unactive
                        {{/if}}
                        " data-type="arme" data-subtype="has" data-value="{{key.arme.has}}">{{key.labels.arme}}</button>
                    </div>

                    <div class="oneLine">
                        <button type="action" class="button
                        {{#if key.overdrives.has}}
                        active
                        {{else}}
                        unactive
                        {{/if}}
                        " data-type="overdrives" data-subtype="has" data-value="{{key.overdrives.has}}">{{key.labels.overdrives}}</button>
                    </div>

                    <div class="oneLine">
                        <button type="action" class="button
                        {{#if key.ersatz.bard.has}}
                        active
                        {{else}}
                        unactive
                        {{/if}}
                        " data-type="ersatz" data-subtype="bard" data-name="has" data-value="{{key.ersatz.bard.has}}">{{key.labels.ersatzBard}}</button>
                    </div>

                    <div class="oneLine">
                        <button type="action" class="button
                        {{#if key.effets.has}}
                        active
                        {{else}}
                        unactive
                        {{/if}}
                        " data-type="effets" data-subtype="has" data-value="{{key.effets.has}}">{{key.labels.effets}}</button>
                    </div>
                </div>
            </div>

            <div class="main bonus {{#unless key.bonus.has}}hidden{{/unless}}">
                <h2 class="header js-toggler">
                    <i class="far fa-minus-square"></i>
                    {{localize "KNIGHT.BONUS.Label"}}
                </h2>

                <div class="col">
                    <div class="twoLine">
                        <button type="action" class="button
                        {{#if key.bonus.armure.has}}
                        active
                        {{else}}
                        unactive
                        {{/if}}
                        " data-type="bonus" data-subtype="armure" data-name="has" data-value="{{key.bonus.armure.has}}">{{key.labels.armure}}</button>
                        <label class="oneLine {{#unless key.bonus.armure.has}}hidden{{/unless}}">
                            <span>{{localize "KNIGHT.LATERAL.Armure"}}</span>
                            <input type="number" name="system.niveau.details.{{nv}}.bonus.armure.value" value="{{key.bonus.armure.value}}" min="0" />
                        </label>
                    </div>

                    <div class="twoLine">
                        <button type="action" class="button
                        {{#if key.bonus.champDeForce.has}}
                        active
                        {{else}}
                        unactive
                        {{/if}}
                        " data-type="bonus" data-subtype="champDeForce" data-name="has" data-value="{{key.bonus.champDeForce.has}}">{{key.labels.champDeForce}}</button>
                        <label class="oneLine {{#unless key.bonus.champDeForce.has}}hidden{{/unless}}">
                            <span>{{localize "KNIGHT.LATERAL.ChampDeForce"}}</span>
                            <input type="number" name="system.niveau.details.{{nv}}.bonus.champDeForce.value" value="{{key.bonus.champDeForce.value}}" min="0" />
                        </label>
                    </div>

                    <div class="twoLine">
                        <button type="action" class="button
                        {{#if key.bonus.energie.has}}
                        active
                        {{else}}
                        unactive
                        {{/if}}
                        " data-type="bonus" data-subtype="energie" data-name="has" data-value="{{key.bonus.energie.has}}">{{key.labels.energie}}</button>
                        <label class="oneLine {{#unless key.bonus.energie.has}}hidden{{/unless}}">
                            <span>{{localize "KNIGHT.LATERAL.Energie"}}</span>
                            <input type="number" name="system.niveau.details.{{nv}}.bonus.energie.value" value="{{key.bonus.energie.value}}" min="0" />
                        </label>
                    </div>

                    <div class="twoLine">
                        <button type="action" class="button
                        {{#if key.bonus.grenades.has}}
                        active
                        {{else}}
                        unactive
                        {{/if}}
                        " data-type="bonus" data-subtype="grenades" data-name="has" data-value="{{key.bonus.grenades.has}}">{{key.labels.bonusGrenades}}</button>

                        {{#each key.bonus.grenades.liste  as | kgr grenade|}}
                            <h3 class="title {{#unless key.bonus.grenades.has}}hidden{{/unless}}">{{getGrenadeName grenade}}</h3>
                            <label class="oneLinewOnlyDice {{#unless key.bonus.grenades.has}}hidden{{/unless}}">
                                <span>{{localize "KNIGHT.BONUS.DesDegats"}}</span>
                                <div>
                                    <input type="number" name="system.niveau.details.{{nv}}.bonus.grenades.liste.{{grenade}}.degats.dice" value="{{kgr.degats.dice}}" min="0" />
                                    <span>{{localize "KNIGHT.JETS.Des-short"}}6</span>
                                </div>
                            </label>
                            <label class="oneLinewOnlyDice {{#unless @last}}borderBottom{{/unless}} {{#unless key.bonus.grenade.has}}hidden{{/unless}}">
                                <span>{{localize "KNIGHT.BONUS.DesViolence"}}</span>
                                <div>
                                    <input type="number" name="system.niveau.details.{{nv}}.bonus.grenades.liste.{{grenade}}.violence.dice" value="{{kgr.violence.dice}}" min="0" />
                                    <span>{{localize "KNIGHT.JETS.Des-short"}}6</span>
                                </div>
                            </label>
                        {{/each}}
                    </div>
                </div>

                <div class="col">
                    <div class="twoLine">
                        <button type="action" class="button
                        {{#if key.bonus.sante.has}}
                        active
                        {{else}}
                        unactive
                        {{/if}}
                        " data-type="bonus" data-subtype="sante" data-name="has" data-value="{{key.bonus.sante.has}}">{{key.labels.sante}}</button>
                        <label class="oneLine {{#unless key.bonus.sante.has}}hidden{{/unless}}">
                            <span>{{localize "KNIGHT.LATERAL.Sante"}}</span>
                            <input type="number" name="system.niveau.details.{{nv}}.bonus.sante.value" value="{{#if key.bonus.sante.value}}{{key.bonus.sante.value}}{{else}}0{{/if}}" min="0" />
                        </label>
                    </div>

                    <div class="twoLine">
                        <button type="action" class="button
                        {{#if key.bonus.degats.has}}
                        active
                        {{else}}
                        unactive
                        {{/if}}
                        " data-type="bonus" data-subtype="degats" data-name="has" data-value="{{key.bonus.degats.has}}">{{key.labels.degatsBonus}}</button>
                        <select name="system.niveau.details.{{nv}}.bonus.degats.type" class="{{#unless key.bonus.degats.has}}hidden{{/unless}}">
                            {{selectOptions (getList 'typebonus') selected=key.bonus.degats.type localize=true}}
                        </select>
                        <button type="action" class="button borderTop noBorderBottom
                        {{#if key.bonus.degats.variable.has}}
                        active
                        {{else}}
                        unactive
                        {{/if}}
                        {{#unless key.bonus.degats.has}}hidden{{/unless}}
                        " data-type="bonus" data-subtype="degats" data-name="variable" data-subname="has" data-value="{{key.bonus.degats.variable.has}}">{{key.labels.degatsVariable}}</button>
                        <div class="oneLinewDice {{#unless key.bonus.degats.has}}hidden{{else}}{{#if key.bonus.degats.variable.has}}hidden{{/if}}{{/unless}}">
                            <span>{{localize "KNIGHT.AUTRE.Degats"}}</span>
                            <div>
                                <input type="number" name="system.niveau.details.{{nv}}.bonus.degats.dice" value="{{key.bonus.degats.dice}}" min="0" />
                                <span>{{localize "KNIGHT.JETS.Des-short"}}6+</span>
                                <input type="number" name="system.niveau.details.{{nv}}.bonus.degats.fixe" value="{{key.bonus.degats.fixe}}" min="0" />
                            </div>
                        </div>
                        <div class="oneLinewOnlyDice {{#unless key.bonus.degats.has}}hidden{{else}}{{#unless key.bonus.degats.variable.has}}hidden{{/unless}}{{/unless}}">
                            <span>{{localize "KNIGHT.ITEMS.MODULE.DEGATS.DesMinimum"}}</span>
                            <div>
                                <input type="number" name="system.niveau.details.{{nv}}.bonus.degats.variable.min.dice" value="{{key.bonus.degats.variable.min.dice}}" min="0" max="{{key.bonus.degats.variable.max.dice}}" />
                                <span>{{localize "KNIGHT.JETS.Des-short"}}6</span>
                            </div>
                        </div>
                        <div class="oneLinewOnlyDice {{#unless key.bonus.degats.has}}hidden{{else}}{{#unless key.bonus.degats.variable.has}}hidden{{/unless}}{{/unless}}">
                            <span>{{localize "KNIGHT.ITEMS.MODULE.DEGATS.DesMaximum"}}</span>
                            <div>
                                <input type="number" name="system.niveau.details.{{nv}}.bonus.degats.variable.max.dice" value="{{key.bonus.degats.variable.max.dice}}" min="{{key.bonus.degats.variable.min.dice}}" />
                                <span>{{localize "KNIGHT.JETS.Des-short"}}6</span>
                        </div>
                        </div>
                        <div class="oneLine {{#unless key.bonus.degats.has}}hidden{{else}}{{#unless key.bonus.degats.variable.has}}hidden{{/unless}}{{/unless}}">
                            <span>{{localize "KNIGHT.ITEMS.MODULE.DEGATS.FixeMinimum"}}</span>
                            <input type="number" name="system.niveau.details.{{nv}}.bonus.degats.variable.min.fixe" value="{{key.bonus.degats.variable.min.fixe}}" min="0" max="{{key.bonus.degats.variable.max.fixe}}" />
                        </div>
                        <div class="oneLine {{#unless systemData.bonus.degats.has}}hidden{{else}}{{#unless systemData.bonus.degats.variable.has}}hidden{{/unless}}{{/unless}}">
                            <span>{{localize "KNIGHT.ITEMS.MODULE.DEGATS.FixeMaximum"}}</span>
                            <input type="number" name="system.niveau.details.{{nv}}.bonus.degats.variable.max.fixe" value="{{key.bonus.degats.variable.max.fixe}}" min="{{key.bonus.degats.variable.min.fixe}}" />
                        </div>
                        <label class="oneLine {{#unless key.bonus.degats.variable.has}}hidden{{/unless}}">
                            <span>{{localize "KNIGHT.ITEMS.MODULE.CoutAugmentation"}}</span>
                            <input type="number" name="system.niveau.details.{{nv}}.bonus.degats.variable.cout" value="{{key.bonus.degats.variable.cout}}" min="0" />
                        </label>
                    </div>

                    <div class="twoLine">
                        <button type="action" class="button
                        {{#if key.bonus.violence.has}}
                        active
                        {{else}}
                        unactive
                        {{/if}}
                        " data-type="bonus" data-subtype="violence" data-name="has" data-value="{{key.bonus.violence.has}}">{{key.labels.violenceBonus}}</button>
                        <select name="system.niveau.details.{{nv}}.bonus.violence.type" class="{{#unless key.bonus.violence.has}}hidden{{/unless}}">
                            {{selectOptions (getList 'typebonus') selected=key.bonus.violence.type localize=true}}
                        </select>
                        <button type="action" class="button borderTop noBorderBottom
                        {{#if key.bonus.violence.variable.has}}
                        active
                        {{else}}
                        unactive
                        {{/if}}
                        {{#unless key.bonus.violence.has}}hidden{{/unless}}
                        " data-type="bonus" data-subtype="violence" data-name="variable" data-subname="has" data-value="{{key.bonus.violence.variable.has}}">{{key.labels.violenceVariable}}</button>
                        <div class="oneLinewDice {{#unless key.bonus.violence.has}}hidden{{else}}{{#if key.bonus.violence.variable.has}}hidden{{/if}}{{/unless}}">
                            <span>{{localize "KNIGHT.AUTRE.Violence"}}</span>
                            <div>
                                <input type="number" name="system.niveau.details.{{nv}}.bonus.violence.dice" value="{{key.bonus.violence.dice}}" min="0" />
                                <span>{{localize "KNIGHT.JETS.Des-short"}}6+</span>
                                <input type="number" name="system.niveau.details.{{nv}}.bonus.violence.fixe" value="{{key.bonus.violence.fixe}}" min="0" />
                            </div>
                        </div>
                        <div class="oneLinewOnlyDice {{#unless key.bonus.violence.has}}hidden{{else}}{{#unless key.bonus.violence.variable.has}}hidden{{/unless}}{{/unless}}">
                            <span>{{localize "KNIGHT.ITEMS.MODULE.VIOLENCE.DesMinimum"}}</span>
                            <div>
                                <input type="number" name="system.niveau.details.{{nv}}.bonus.violence.variable.min.dice" value="{{key.bonus.violence.variable.min.dice}}" min="0" max="{{key.bonus.violence.variable.max.dice}}" />
                                <span>{{localize "KNIGHT.JETS.Des-short"}}6</span>
                            </div>
                        </div>
                        <div class="oneLinewOnlyDice {{#unless key.bonus.violence.has}}hidden{{else}}{{#unless key.bonus.violence.variable.has}}hidden{{/unless}}{{/unless}}">
                            <span>{{localize "KNIGHT.ITEMS.MODULE.VIOLENCE.DesMaximum"}}</span>
                            <div>
                                <input type="number" name="system.niveau.details.{{nv}}.bonus.violence.variable.max.dice" value="{{key.bonus.violence.variable.max.dice}}" min="{{key.bonus.violence.variable.min.dice}}" />
                                <span>{{localize "KNIGHT.JETS.Des-short"}}6</span>
                            </div>
                        </div>
                        <div class="oneLine {{#unless systemData.bonus.violence.has}}hidden{{else}}{{#unless systemData.bonus.violence.variable.has}}hidden{{/unless}}{{/unless}}">
                            <span>{{localize "KNIGHT.ITEMS.MODULE.VIOLENCE.FixeMinimum"}}</span>
                            <input type="number" name="system.niveau.details.{{nv}}.bonus.violence.variable.min.fixe" value="{{key.bonus.violence.variable.min.fixe}}" min="0" max="{{key.bonus.violence.variable.max.fixe}}" />
                        </div>
                        <div class="oneLine {{#unless key.bonus.violence.has}}hidden{{else}}{{#unless key.bonus.violence.variable.has}}hidden{{/unless}}{{/unless}}">
                            <span>{{localize "KNIGHT.ITEMS.MODULE.VIOLENCE.FixeMaximum"}}</span>
                            <input type="number" name="system.niveau.details.{{nv}}.bonus.violence.variable.max.fixe" value="{{key.bonus.violence.variable.max.fixe}}" min="{{key.bonus.violence.variable.min.fixe}}" />
                        </div>
                        <label class="oneLine {{#unless systemData.bonus.degats.variable.has}}hidden{{/unless}}">
                            <span>{{localize "KNIGHT.ITEMS.MODULE.CoutAugmentation"}}</span>
                            <input type="number" name="system.niveau.details.{{nv}}.bonus.violence.variable.cout" value="{{key.bonus.violence.variable.cout}}" min="0" />
                        </label>
                    </div>

                    <div class="oneLine">
                        <button type="action" class="button borderTop noBorderBottom
                        {{#if key.bonus.overdrives.has}}
                        active
                        {{else}}
                        unactive
                        {{/if}}
                        " data-type="bonus" data-subtype="overdrives" data-name="has" data-value="{{key.bonus.overdrives.has}}">{{key.labels.bonusOverdrives}}</button>
                    </div>
                </div>

                <div class="main overdrives {{#unless key.bonus.overdrives.has}}hidden{{/unless}}">
                    <h2 class="header js-toggler">
                        <i class="far fa-minus-square"></i>
                        {{localize "KNIGHT.ITEMS.MODULE.OVERDRIVES.Labelbonus"}}
                    </h2>

                    {{#each key.bonus.overdrives.aspects  as | kAspect aspect|}}
                        <div class="col3">
                            <h3>{{getAspect aspect}}</h3>
                            {{#each kAspect  as | kCarac carac|}}
                                <label class="oneLine">
                                    <span>{{getCarac carac}}</span>
                                    <input type="number" name="system.niveau.details.{{nv}}.bonus.overdrives.aspects.{{aspect}}.{{carac}}" value="{{kCarac}}" />
                                </label>
                            {{/each}}
                        </div>
                    {{/each}}
                </div>
            </div>

            <div class="main baseeffets {{#unless key.effets.has}}hidden{{/unless}}">
                <h2 class="header js-toggler">
                    <i class="far fa-minus-square"></i>
                    {{localize "KNIGHT.EFFETS.Label"}}
                </h2>

                <div class="effets">
                    {{#each key.effets.liste as | keff effet|}}
                        {{~> systems/knight/templates/parts/effets.html type='module'}}
                    {{/each}}
                    <a class="edit" data-path="system.niveau.details.{{nv}}.effets">
                        <span>{{localize "KNIGHT.EFFETS.Edit"}}</span>
                    </a>
                </div>
            </div>

            <div class="main arme {{#unless key.arme.has}}hidden{{/unless}}">
                <h2 class="header js-toggler">
                    <i class="far fa-minus-square"></i>
                    {{localize "KNIGHT.ITEMS.MODULE.ARME.Label"}}
                </h2>

                <div class="col">
                    <label class="oneLine">
                        <span>{{localize "KNIGHT.ITEMS.MODULE.ARME.TYPE.Label"}}</span>
                        <select name="system.niveau.details.{{nv}}.arme.type">
                            {{selectOptions (getList 'typearmes') selected=key.arme.type localize=true}}
                        </select>
                    </label>

                    <label class="oneLine">
                        <span>{{localize "KNIGHT.PORTEE.Label"}}</span>
                        <select name="system.niveau.details.{{nv}}.arme.portee">
                            {{selectOptions (getList 'portee') selected=key.arme.portee localize=true}}
                        </select>
                    </label>

                    {{#if (isWpnDistance key.arme.type)}}
                        <button type="action" class="optionsMunitions button {{#if key.arme.optionsmunitions.has}}selected{{else}}unselected{{/if}}"
                        data-key="{{nv}}" data-type="arme" data-subtype="optionsmunitions" data-name="has" data-value="{{key.arme.optionsmunitions.has}}">
                            {{#if key.arme.optionsmunitions.has}}
                                {{localize "KNIGHT.ITEMS.ARME.MUNITIONS.Has"}}
                            {{else}}
                                {{localize "KNIGHT.ITEMS.ARME.MUNITIONS.Hasnt"}}
                            {{/if}}
                        </button>

                        {{#if key.arme.optionsmunitions.has}}
                            <label class="oneLine optionsMunitions">
                                <span class="header">{{localize "KNIGHT.ITEMS.ARME.MUNITIONS.Combiens"}}</span>
                                <input type="number" name="system.niveau.details.{{nv}}.arme.optionsmunitions.value" value="{{#if key.arme.optionsmunitions.value}}{{key.arme.optionsmunitions.value}}{{else}}1{{/if}}" min="0" />
                            </label>
                            <button type="action" class="optionsMunitionsValider"
                                data-key="{{nv}}"
                                data-value="{{key.arme.optionsmunitions.value}}">
                                {{localize "KNIGHT.AUTRE.Valider"}}
                            </button>
                        {{/if}}
                    {{/if}}
                </div>

                <div class="col">
                    {{#unless (wpnHasMunitions (isWpnDistance key.arme.type) key.arme.optionsmunitions.has)}}
                        <div class="twoLine">
                            <button type="action" class="button borderTop noBorderBottom
                            {{#if key.arme.degats.variable.has}}
                            active
                            {{else}}
                            unactive
                            {{/if}}
                            " data-type="arme" data-subtype="degats" data-name="variable" data-subname="has" data-value="{{key.arme.degats.variable.has}}">{{key.labels.armeDegatsVariable}}</button>
                            <div class="oneLinewDice {{#if key.arme.degats.variable.has}}hidden{{/if}}">
                                <span>{{localize "KNIGHT.AUTRE.Degats"}}</span>
                                <div>
                                    <input type="number" class="dgtsDBase" name="system.niveau.details.{{nv}}.arme.degats.dice" value="{{key.arme.degats.dice}}" min="0" />
                                    <span>{{localize "KNIGHT.JETS.Des-short"}}6+</span>
                                    <input type="number" class="dgtsF dgtsFBase" name="system.niveau.details.{{nv}}.arme.degats.fixe" value="{{key.arme.degats.fixe}}" min="0" />
                                </div>
                            </div>
                            <div class="oneLinewDice {{#unless key.arme.degats.variable.has}}hidden{{/unless}}">
                                <span>{{localize "KNIGHT.ITEMS.MODULE.DEGATS.Minimum"}}</span>
                                <div>
                                    <input type="number" class="dgtsD" name="system.niveau.details.{{nv}}.arme.degats.variable.min.dice" value="{{key.arme.degats.variable.min.dice}}" min="0" max="{{key.arme.degats.variable.max.dice}}" />
                                    <span>{{localize "KNIGHT.JETS.Des-short"}}6+</span>
                                    <input type="number" class="dgtsF dgtsMin" name="system.niveau.details.{{nv}}.arme.degats.variable.min.fixe" value="{{key.arme.degats.fixe}}" />
                                </div>
                            </div>
                            <div class="oneLinewDice {{#unless key.arme.degats.variable.has}}hidden{{/unless}}">
                                <span>{{localize "KNIGHT.ITEMS.MODULE.DEGATS.Maximum"}}</span>
                                <div>
                                    <input type="number" name="system.niveau.details.{{nv}}.arme.degats.variable.max.dice" value="{{key.arme.degats.variable.max.dice}}" min="{{key.arme.degats.variable.min.dice}}" />
                                    <span>{{localize "KNIGHT.JETS.Des-short"}}6+</span>
                                    <input type="number" class="dgtsF dgtsMax" name="system.niveau.details.{{nv}}.arme.degats.variable.max.fixe" value="{{key.arme.degats.fixe}}" />
                                </div>
                            </div>
                            <label class="oneLine {{#unless key.arme.degats.variable.has}}hidden{{/unless}}">
                                <span>{{localize "KNIGHT.ITEMS.MODULE.CoutAugmentation"}}</span>
                                <input type="number" name="system.niveau.details.{{nv}}.arme.degats.variable.cout" value="{{key.arme.degats.variable.cout}}" />
                            </label>
                        </div>

                        <div class="twoLine">
                            <button type="action" class="button borderTop noBorderBottom
                            {{#if key.arme.violence.variable.has}}
                            active
                            {{else}}
                            unactive
                            {{/if}}
                            " data-type="arme" data-subtype="violence" data-name="variable" data-subname="has" data-value="{{key.arme.violence.variable.has}}">{{key.labels.armeViolenceVariable}}</button>
                            <div class="oneLinewDice {{#if key.arme.violence.variable.has}}hidden{{/if}}">
                                <span>{{localize "KNIGHT.AUTRE.Violence"}}</span>
                                <div>
                                    <input type="number" class="violenceDBase" name="system.niveau.details.{{nv}}.arme.violence.dice" value="{{key.arme.violence.dice}}" min="0" />
                                    <span>{{localize "KNIGHT.JETS.Des-short"}}6+</span>
                                    <input type="number" class="violenceF violenceFBase" name="system.niveau.details.{{nv}}.arme.violence.fixe" value="{{key.arme.violence.fixe}}" min="0" />
                                </div>
                            </div>
                            <div class="oneLinewDice {{#unless key.arme.violence.variable.has}}hidden{{/unless}}">
                                <span>{{localize "KNIGHT.ITEMS.MODULE.VIOLENCE.Minimum"}}</span>
                                <div>
                                    <input type="number" class="violenceD" name="system.niveau.details.{{nv}}.arme.violence.variable.min.dice" value="{{key.arme.violence.variable.min.dice}}" min="0" max="{{key.arme.violence.variable.max.dice}}" />
                                    <span>{{localize "KNIGHT.JETS.Des-short"}}6+</span>
                                    <input type="number" class="violenceF violenceMin" name="system.niveau.details.{{nv}}.arme.violence.variable.min.fixe" value="{{key.arme.violence.fixe}}" min="0" />
                                </div>
                            </div>
                            <div class="oneLinewDice {{#unless key.arme.violence.variable.has}}hidden{{/unless}}">
                                <span>{{localize "KNIGHT.ITEMS.MODULE.VIOLENCE.Maximum"}}</span>
                                <div>
                                    <input type="number" name="system.niveau.details.{{nv}}.arme.violence.variable.max.dice" value="{{key.arme.violence.variable.max.dice}}" min="{{key.arme.violence.variable.min.dice}}" />
                                    <span>{{localize "KNIGHT.JETS.Des-short"}}6+</span>
                                    <input type="number" class="violenceF violenceMax" name="system.niveau.details.{{nv}}.arme.violence.variable.max.fixe" value="{{key.arme.violence.fixe}}" min="0" />
                                </div>
                            </div>
                            <label class="oneLine {{#unless key.arme.violence.variable.has}}hidden{{/unless}}">
                                <span>{{localize "KNIGHT.ITEMS.MODULE.CoutAugmentation"}}</span>
                                <input type="number" name="system.niveau.details.{{nv}}.arme.violence.variable.cout" value="{{key.arme.violence.variable.cout}}" />
                            </label>
                        </div>
                    {{/unless}}

                    {{#if (wpnHasMunitions (isWpnDistance key.arme.type) key.arme.optionsmunitions.has)}}
                        <div class="blockMunitions">
                            {{#each key.arme.optionsmunitions.liste as | kM effet|}}
                            <div>
                                <label class="munitionListe">
                                    <span class="header">{{localize "KNIGHT.ITEMS.ARME.MUNITIONS.Label"}} : </span>
                                    <input type="text" name="system.niveau.details.{{nv}}.arme.optionsmunitions.liste.{{effet}}.nom" value="{{kM.nom}}" />
                                </label>
                                <label class="demi">
                                    <span class="header">{{localize "KNIGHT.AUTRE.Degats"}}</span>
                                    <div>
                                        <input type="number" name="system.niveau.details.{{nv}}.arme.optionsmunitions.liste.{{effet}}.degats.dice" value="{{kM.degats.dice}}" min="0" />
                                        <span>{{localize "KNIGHT.JETS.Des-short"}}6+</span>
                                        <input type="number" name="system.niveau.details.{{nv}}.arme.optionsmunitions.liste.{{effet}}.degats.fixe" value="{{kM.degats.fixe}}" />
                                    </div>
                                </label>
                                <label class="demi">
                                    <span class="header">{{localize "KNIGHT.AUTRE.Violence"}}</span>
                                    <div>
                                        <input type="number" name="system.niveau.details.{{nv}}.arme.optionsmunitions.liste.{{effet}}.violence.dice" value="{{kM.violence.dice}}" min="0" />
                                        <span>{{localize "KNIGHT.JETS.Des-short"}}6+</span>
                                        <input type="number" name="system.niveau.details.{{nv}}.arme.optionsmunitions.liste.{{effet}}.violence.fixe" value="{{kM.violence.fixe}}" />
                                    </div>
                                </label>
                            </div>
                            {{/each}}
                        </div>
                    {{/if}}
                </div>

                <div class="blockEffets space">
                    <h2 class="header">
                        {{localize "KNIGHT.EFFETS.Label"}}
                        {{#if (isWpnDistance key.arme.type)}}
                            {{#if key.arme.optionsmunitions.has}}
                                - {{localize "KNIGHT.AUTRE.Base"}}
                            {{/if}}
                        {{/if}}
                    </h2>
                    <div class="effets">
                        {{#each key.arme.effets.liste as | ke effet|}}
                            {{~> systems/knight/templates/parts/effets.html type='base'}}
                        {{/each}}
                        <a class="edit" data-path="system.niveau.details.{{nv}}.arme.effets">
                            <span>{{localize "KNIGHT.EFFETS.Edit"}}</span>
                        </a>
                    </div>
                </div>

                {{#if (isWpnDistance key.arme.type)}}
                    {{#if key.arme.optionsmunitions.has}}
                        {{#each key.arme.optionsmunitions.liste as | kM munition|}}
                        <div class="blockEffets" data-id="{{munition}}">
                            <h2 class="header js-toggler">
                                <i class="far fa-minus-square"></i>
                                {{localize "KNIGHT.EFFETS.Label"}} - {{kM.nom}}
                            </h2>

                            <div class="effets">
                                {{#each kM.liste as | kE effet|}}
                                    {{~> systems/knight/templates/parts/effets.html type='munition' munition=munition}}
                                {{/each}}
                                <a class="edit" data-path="system.niveau.details.{{nv}}.arme.optionsmunitions.liste.{{munition}}">
                                    <span>{{localize "KNIGHT.EFFETS.Edit"}}</span>
                                </a>
                            </div>
                        </div>
                        {{/each}}
                    {{/if}}
                {{/if}}

                {{#if (isWpnDistance key.arme.type)}}
                <div class="blockEffets">
                    <h2 class="header">
                        {{localize "KNIGHT.AMELIORATIONS.LABEL.Distance"}}
                    </h2>
                    <div class="effets">
                        {{#each key.arme.distance.liste as | ke effet|}}
                            {{~> systems/knight/templates/parts/effets.html type='distance'}}
                        {{/each}}
                        <a class="edit" data-path="system.niveau.details.{{nv}}.arme.distance" data-type="distance">
                            <span>{{localize "KNIGHT.EFFETS.Edit"}}</span>
                        </a>
                    </div>
                </div>

                {{else}}
                <div class="blockEffets">
                    <h2 class="header">
                        {{localize "KNIGHT.AMELIORATIONS.LABEL.Structurelles"}}
                    </h2>
                    <div class="effets">
                        {{#each key.arme.structurelles.liste as | ke effet|}}
                            {{~> systems/knight/templates/parts/effets.html type='structurelle'}}
                        {{/each}}
                        <a class="edit" data-path="system.niveau.details.{{nv}}.arme.structurelles" data-type="structurelles">
                            <span>{{localize "KNIGHT.EFFETS.Edit"}}</span>
                        </a>
                    </div>
                </div>

                <div class="blockEffets">
                    <h2 class="header">
                        {{localize "KNIGHT.AMELIORATIONS.LABEL.Ornementales"}}
                    </h2>
                    <div class="effets">
                        {{#each key.arme.ornementales.liste as | ke effet|}}
                            {{~> systems/knight/templates/parts/effets.html type='ornementale'}}
                        {{/each}}
                        <a class="edit" data-path="system.niveau.details.{{nv}}.arme.ornementales"  data-type="ornementales">
                            <span>{{localize "KNIGHT.EFFETS.Edit"}}</span>
                        </a>
                    </div>
                </div>
                {{/if}}
            </div>

            <div class="main pnj {{#unless key.pnj.has}}hidden{{/unless}}">
                <h2 class="header js-toggler">
                    <i class="far fa-minus-square"></i>
                    {{key.labels.pnjTitle}}

                    <a class="create" data-type="pnj" title="Create Item">
                        <i class="fas fa-plus"></i>
                    </a>
                </h2>
                {{#each key.pnj.liste  as | kpnj pnj|}}
                    <div class="creature baseW">
                        <div class="line header">
                            <select name="system.niveau.details.{{nv}}.pnj.liste.{{pnj}}.type" class="typePNJ" data-id="{{pnj}}">
                                {{selectOptions (getList 'typepnj') selected=kpnj.type localize=true}}
                            </select>
                            <input type="text" name="system.niveau.details.{{nv}}.pnj.liste.{{pnj}}.nom" value="{{kpnj.nom}}" />
                            <a class="delete" data-type="pnj" data-id="{{pnj}}" title="Delete Item">
                                <i class="fas fa-minus"></i>
                            </a>
                        </div>

                        <div class="line">
                            <button type="action" class="button
                            {{#if kpnj.aspects.has}}
                            active
                            {{else}}
                            unactive
                            {{/if}}
                            " data-type="pnj" data-subtype="liste" data-name="array" data-num="{{pnj}}" data-subname="aspects" data-special="has" data-value="{{kpnj.aspects.has}}">
                            {{#if kpnj.aspects.has}}
                            {{localize "KNIGHT.ITEMS.MODULE.PNJ.ASPECTS.Has"}}
                            {{else}}
                            {{localize "KNIGHT.ITEMS.MODULE.PNJ.ASPECTS.Hasnt"}}
                            {{/if}}
                            </button>

                            {{#unless (isBande kpnj.type)}}
                                <button type="action" class="button
                                {{#if kpnj.armes.has}}
                                active
                                {{else}}
                                unactive
                                {{/if}}
                                " data-type="pnj" data-subtype="liste" data-name="array" data-num="{{pnj}}" data-subname="armes" data-special="has" data-value="{{kpnj.armes.has}}">
                                {{#if kpnj.armes.has}}
                                {{localize "KNIGHT.ITEMS.MODULE.PNJ.ARMES.Has"}}
                                {{else}}
                                {{localize "KNIGHT.ITEMS.MODULE.PNJ.ARMES.Hasnt"}}
                                {{/if}}
                                </button>
                            {{/unless}}

                            <button type="action" class="button
                            {{#if kpnj.jetSpecial.has}}
                            active
                            {{else}}
                            unactive
                            {{/if}}
                            " data-type="pnj" data-subtype="liste" data-name="array" data-num="{{pnj}}" data-subname="jetSpecial" data-special="has" data-value="{{kpnj.jetSpecial.has}}">
                            {{#if kpnj.jetSpecial.has}}
                            {{localize "KNIGHT.ITEMS.MODULE.PNJ.JETSPECIAL.Has"}}
                            {{else}}
                            {{localize "KNIGHT.ITEMS.MODULE.PNJ.JETSPECIAL.Hasnt"}}
                            {{/if}}
                            </button>
                        </div>

                        <div class="aspects {{#unless kpnj.aspects.has}}hidden{{/unless}}">
                        {{#each kpnj.aspects.liste  as | kAsp aspect|}}
                            <div>
                                <label class="oneLine">
                                    <span>{{getAspect aspect}}</span>
                                    <input type="number" name="system.niveau.details.{{nv}}.pnj.liste.{{pnj}}.aspects.liste.{{aspect}}.value" value="{{kAsp.value}}" min="0" max="20" />
                                </label>
                                <h3>{{localize "KNIGHT.ASPECTS.Exceptionnels"}}</h3>
                                <label class="oneLine">
                                    <span>{{localize "KNIGHT.AUTRE.Mineur"}}</span>
                                    <input type="number" name="system.niveau.details.{{nv}}.pnj.liste.{{pnj}}.aspects.liste.{{aspect}}.ae.mineur" value="{{kAsp.ae.mineur}}" min="0" max="10" />
                                </label>
                                <label class="oneLine">
                                    <span>{{localize "KNIGHT.AUTRE.Majeur"}}</span>
                                    <input type="number" name="system.niveau.details.{{nv}}.pnj.liste.{{pnj}}.aspects.liste.{{aspect}}.ae.majeur" value="{{kAsp.ae.majeur}}" min="0" max="10" />
                                </label>
                            </div>
                        {{/each}}
                        </div>

                        <div class="col3">
                            <label class="oneLine {{#unless (isBande kpnj.type)}}hidden{{/unless}}">
                                <span>{{localize "KNIGHT.AUTRE.Debordement"}}</span>
                                <input type="number" name="system.niveau.details.{{nv}}.pnj.liste.{{pnj}}.debordement" value="{{kpnj.debordement}}"/>
                            </label>

                            <div class="oneLinewDice {{#unless (isBande kpnj.type)}}noMarginTop{{/unless}}">
                                <span>{{localize "KNIGHT.LATERAL.Initiative"}}</span>
                                <div>
                                    <input type="number" name="system.niveau.details.{{nv}}.pnj.liste.{{pnj}}.initiative.dice" value="{{kpnj.initiative.dice}}" min="0" />
                                    <span>{{localize "KNIGHT.JETS.Des-short"}}6+</span>
                                    <input type="number" name="system.pnj.liste.{{pnj}}.initiative.fixe" value="{{kpnj.initiative.fixe}}" min="0" />
                                </div>
                            </div>

                            <label class="oneLine {{#unless (isBande kpnj.type)}}hidden{{/unless}}">
                                <span>{{localize "KNIGHT.LATERAL.Cohesion"}}</span>
                                <input type="number" name="system.niveau.details.{{nv}}.pnj.liste.{{pnj}}.sante" value="{{kpnj.sante}}"/>
                            </label>
                        </div>

                        <div class="col3">
                            <label class="oneLine">
                                <span>{{localize "KNIGHT.LATERAL.Reaction"}}</span>
                                <input type="number" name="system.niveau.details.{{nv}}.pnj.liste.{{pnj}}.reaction" value="{{kpnj.reaction}}"/>
                            </label>

                            <label class="oneLine">
                                <span>{{localize "KNIGHT.LATERAL.Defense"}}</span>
                                <input type="number" name="system.niveau.details.{{nv}}.pnj.liste.{{pnj}}.defense" value="{{kpnj.defense}}"/>
                            </label>
                        </div>

                        <div class="col3">
                            <label class="oneLine">
                                <span>{{localize "KNIGHT.LATERAL.Armure"}}</span>
                                <input type="number" name="system.niveau.details.{{nv}}.pnj.liste.{{pnj}}.armure" value="{{kpnj.armure}}"/>
                            </label>

                            <label class="oneLine">
                                <span>{{localize "KNIGHT.LATERAL.ChampDeForce"}}</span>
                                <input type="number" name="system.niveau.details.{{nv}}.pnj.liste.{{pnj}}.champDeForce" value="{{kpnj.champDeForce}}"/>
                            </label>
                        </div>

                        {{#unless (isBande kpnj.type)}}
                            <div class="armes {{#unless kpnj.armes.has}}hidden{{/unless}}">
                                <h3>
                                    {{localize "KNIGHT.ITEMS.MODULE.ARME.Label"}}
                                    <a class="create" data-type="armes" data-id="{{pnj}}" title="Create Item">
                                        <i class="fas fa-plus"></i>
                                    </a>
                                </h3>
                                {{#each kpnj.armes.liste  as | aKey arme|}}
                                    <div>
                                        <div class="header">
                                            <span class="nom">{{localize "KNIGHT.Nom"}}</span>
                                            <span class="type">{{localize "KNIGHT.ITEMS.MODULE.ARME.TYPE.Label"}}</span>

                                            <a class="delete" data-type="armes" data-pnj="{{pnj}}" data-id="{{arme}}" title="Delete Item">
                                                <i class="fas fa-minus"></i>
                                            </a>
                                        </div>
                                        <div class="line">
                                            <div class="nom">
                                                <input type="text" name="system.niveau.details.{{nv}}.pnj.liste.{{pnj}}.armes.liste.{{arme}}.nom" value="{{aKey.nom}}" />
                                            </div>

                                            <div class="type">
                                                <select name="system.niveau.details.{{nv}}.pnj.liste.{{pnj}}.armes.liste.{{arme}}.type">
                                                    {{selectOptions (getList 'typearmesmodules') selected=aKey.type localize=true}}
                                                </select>
                                            </div>
                                        </div>
                                        <div class="header">
                                            <span class="portee">{{localize "KNIGHT.PORTEE.Label"}}</span>
                                            <span class="degats">{{localize "KNIGHT.AUTRE.Degats"}}</span>
                                            <span class="violence">{{localize "KNIGHT.AUTRE.Violence"}}</span>
                                        </div>
                                        <div class="line">
                                            <div class="portee">
                                                <select name="system.niveau.details.{{nv}}.pnj.liste.{{pnj}}.armes.liste.{{arme}}.portee">
                                                    {{selectOptions (getList 'portee') selected=aKey.portee localize=true}}
                                                </select>
                                            </div>

                                            <div class="degats">
                                                <input type="number" name="system.niveau.details.{{nv}}.pnj.liste.{{pnj}}.armes.liste.{{arme}}.degats.dice" value="{{aKey.degats.dice}}" min="0" />
                                                <span>{{localize "KNIGHT.JETS.Des-short"}}6+</span>
                                                <input type="number" name="system.niveau.details.{{nv}}.pnj.liste.{{pnj}}.armes.liste.{{arme}}.degats.fixe" value="{{aKey.degats.fixe}}" min="0" />
                                            </div>

                                            <div class="violence">
                                                <input type="number" name="system.niveau.details.{{nv}}.pnj.liste.{{pnj}}.armes.liste.{{arme}}.violence.dice" value="{{aKey.violence.dice}}" min="0" />
                                                <span>{{localize "KNIGHT.JETS.Des-short"}}6+</span>
                                                <input type="number" name="system.niveau.details.{{nv}}.pnj.liste.{{pnj}}.armes.liste.{{arme}}.violence.fixe" value="{{aKey.violence.fixe}}" min="0" />
                                            </div>
                                        </div>
                                        {{#if (isValue aKey.type 'tourelle')}}
                                        <div class="header">
                                            <span class="attaque">{{localize "KNIGHT.AUTRE.Attaque"}}</span>
                                        </div>
                                        <div class="line">
                                            <div class="attaque">
                                                <input type="number" name="system.niveau.details.{{nv}}.pnj.liste.{{pnj}}.armes.liste.{{arme}}.attaque.dice" value="{{aKey.attaque.dice}}" min="0" />
                                                <span>{{localize "KNIGHT.JETS.Des-short"}}6+</span>
                                                <input type="number" name="system.niveau.details.{{nv}}.pnj.liste.{{pnj}}.armes.liste.{{arme}}.attaque.fixe" value="{{aKey.attaque.fixe}}" min="0" />
                                            </div>
                                        </div>
                                        {{/if}}
                                        <div class="effets">
                                            {{#each aKey.effets.liste as | kEffet effet|}}
                                                {{~> systems/knight/templates/parts/effets.html type='pnjwpn' pnj=pnj wpn=arme}}
                                            {{/each}}
                                            <a class="edit" data-path="system.niveau.details.{{nv}}.pnj.liste.{{pnj}}.armes.liste.{{arme}}.effets">
                                                <span>{{localize "KNIGHT.EFFETS.Edit"}}</span>
                                            </a>
                                        </div>
                                    </div>
                                {{/each}}
                            </div>
                        {{/unless}}

                        <div class="jetsSpecifiques {{#unless kpnj.jetSpecial.has}}hidden{{/unless}}">
                            <h3>
                                {{localize "KNIGHT.ITEMS.MODULE.PNJ.JETSPECIAL.Label"}}
                                <a class="create" data-type="jetSpecifiques" data-id="{{pnj}}" title="Create Item">
                                    <i class="fas fa-plus"></i>
                                </a>
                            </h3>
                            {{#each kpnj.jetSpecial.liste  as | kJet jet|}}
                                <div>
                                    <div class="header">
                                        <input type="text" name="system.niveau.details.{{nv}}.pnj.liste.{{pnj}}.jetSpecial.liste.{{jet}}.nom" value="{{kJet.nom}}" placeholder="{{localize "KNIGHT.Nom"}}"/>
                                        <a class="delete" data-type="jetSpecifiques" data-pnj="{{pnj}}" data-id="{{jet}}" title="Delete Item">
                                            <i class="fas fa-minus"></i>
                                        </a>
                                    </div>

                                    <label class="dice">
                                        <input type="number" name="system.niveau.details.{{nv}}.pnj.liste.{{pnj}}.jetSpecial.liste.{{jet}}.dice" value="{{kJet.dice}}" min="0" />
                                        <span>{{localize "KNIGHT.JETS.Des-short"}}6</span>
                                    </label>

                                    <label class="od">
                                        <span>{{localize "KNIGHT.ASPECTS.OD"}}</span>
                                        <input type="number" name="system.niveau.details.{{nv}}.pnj.liste.{{pnj}}.jetSpecial.liste.{{jet}}.overdrive" value="{{kJet.overdrive}}" min="0" />
                                    </label>
                                </div>
                            {{/each}}
                        </div>
                    </div>
                {{/each}}
            </div>

            <div class="main overdrives {{#unless key.overdrives.has}}hidden{{/unless}}">
                <h2 class="header js-toggler">
                    <i class="far fa-minus-square"></i>
                    {{localize "KNIGHT.ITEMS.MODULE.OVERDRIVES.Label"}}
                </h2>

                {{#each key.overdrives.aspects  as | kAspect aspect|}}
                    <div class="col3">
                        <h3>{{getAspect aspect}}</h3>
                        {{#each kAspect  as | kCarac carac|}}
                            <label class="oneLine">
                                <span>{{getCarac carac}}</span>
                                <input type="number" name="system.niveau.details.{{nv}}.overdrives.aspects.{{aspect}}.{{carac}}" value="{{kCarac}}" />
                            </label>
                        {{/each}}
                    </div>
                {{/each}}
            </div>

            <div class="main rogue {{#unless key.ersatz.rogue.has}}hidden{{/unless}}">
                <h2 class="header js-toggler">
                    <i class="far fa-minus-square"></i>
                    {{localize "KNIGHT.ITEMS.MODULE.ERSATZ.ROGUE.Label"}}
                </h2>

                <div class="col">
                    <label class="longspan">
                        <span>{{localize "KNIGHT.ITEMS.ARMURE.CAPACITES.GHOST.BonusPasserInaperu"}}</span>
                        <input type="number" name="system.niveau.details.{{nv}}.ersatz.rogue.reussites" value="{{key.ersatz.rogue.reussites}}" min="0" />
                    </label>

                    <div class="oneLine">
                        <button type="action" class="button {{#if key.ersatz.rogue.interruption.actif}}active{{/if}}"
                        data-type="ersatz" data-subtype="rogue" data-name="interruption" data-subname="actif" data-value="{{key.ersatz.rogue.interruption.actif}}">
                            {{#if key.ersatz.rogue.interruption.actif}}
                            {{localize "KNIGHT.ITEMS.ARMURE.CAPACITES.GHOST.Interruption"}}
                            {{else}}
                            {{localize "KNIGHT.ITEMS.ARMURE.CAPACITES.GHOST.NoInterruption"}}
                            {{/if}}
                        </button>
                    </div>

                    <label class="oneLine">
                        <span>{{localize "KNIGHT.BONUS.Attaque"}}</span>
                        <select name="system.niveau.details.{{nv}}.ersatz.rogue.attaque">
                            {{selectOptions (onlyCarac) selected=key.ersatz.rogue.attaque localize=true}}
                        </select>
                    </label>
                </div>

                <div class="col">
                    <h3 class="title">{{localize "KNIGHT.BONUS.Degats"}}</h3>
                    <div class="twoLine">
                        <label class="oneLine borderBottom noBorderTop">
                            <span>{{localize "KNIGHT.ITEMS.Caracteristique"}}</span>
                            <select name="system.niveau.details.{{nv}}.ersatz.rogue.degats.caracteristique">
                                {{selectOptions (onlyCarac) selected=key.ersatz.rogue.degats.caracteristique localize=true}}
                            </select>
                        </label>

                        <button type="action" class="button {{#if key.ersatz.rogue.degats.od}}active{{/if}}"
                        data-type="ersatz" data-subtype="rogue" data-name="degats" data-subname="od" data-value="{{key.ersatz.rogue.degats.od}}">
                            {{#if key.ersatz.rogue.degats.od}}
                            {{localize "KNIGHT.INCLUS.Od"}}
                            {{else}}
                            {{localize "KNIGHT.NOINCLUS.Od"}}
                            {{/if}}
                        </button>

                        <button type="action" class="button {{#if key.ersatz.rogue.degats.dice}}active{{/if}}"
                        data-type="ersatz" data-subtype="rogue" data-name="degats" data-subname="dice" data-value="{{key.ersatz.rogue.degats.dice}}">
                            {{#if key.ersatz.rogue.degats.dice}}
                            {{localize "KNIGHT.INCLUS.Dice"}}
                            {{else}}
                            {{localize "KNIGHT.NOINCLUS.Dice"}}
                            {{/if}}
                        </button>

                        <button type="action" class="button {{#if key.ersatz.rogue.degats.fixe}}active{{/if}}"
                        data-type="ersatz" data-subtype="rogue" data-name="degats" data-subname="fixe" data-value="{{key.ersatz.rogue.degats.fixe}}">
                            {{#if key.ersatz.rogue.degats.fixe}}
                            {{localize "KNIGHT.INCLUS.Fixe"}}
                            {{else}}
                            {{localize "KNIGHT.NOINCLUS.Fixe"}}
                            {{/if}}
                        </button>
                    </div>
                </div>
            </div>

            <div class="main jetsimple {{#unless key.jetsimple.has}}hidden{{/unless}}">
                <h2 class="header js-toggler">
                    <i class="far fa-minus-square"></i>
                    {{localize "KNIGHT.ITEMS.MODULE.JETSIMPLE.Label"}}
                </h2>

                <div class="col">
                    <label class="shortspan">
                        <span>{{localize "KNIGHT.JETS.Nom"}}</span>
                        <input type="text" name="system.niveau.details.{{nv}}.jetsimple.label" value="{{key.jetsimple.label}}"/>
                    </label>
                </div>

                <div class="col">
                    <label class="shortspan">
                        <span>{{localize "KNIGHT.JETS.Label"}}</span>
                        <input type="text" name="system.niveau.details.{{nv}}.jetsimple.jet" value="{{key.jetsimple.jet}}"/>
                    </label>
                </div>

                <div class="blockEffets space">
                    <h2 class="header">
                        {{localize "KNIGHT.EFFETS.Label"}}
                    </h2>
                    <div class="effets">
                        {{#each key.jetsimple.effets.liste as | ke effet|}}
                            {{~> systems/knight/templates/parts/effets.html type='jetsimple'}}
                        {{/each}}
                        <a class="edit" data-path="system.niveau.details.{{nv}}.jetsimple.effets">
                            <span>{{localize "KNIGHT.EFFETS.Edit"}}</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
        {{/each}}
    </section>
</form>
